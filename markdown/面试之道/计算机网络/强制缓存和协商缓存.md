# 强制缓存和协商缓存

## 缓存的工作原理

我们请求资源需要看看自己有没有缓存，如果没有缓存就问服务器索取，如果有缓存，就要检查缓存的新鲜度，查看缓存是否过期，如果缓存是新鲜的，没有过期就可以直接使用。如果缓存是不新鲜的过期了，就得和服务器进行验证。如果服务器告知没有过期，那就可以继续使用缓存。如果服务器告知已经过期，那就返回新的资源作为新的缓存。

**http请求头里面有两个控制缓存的首部 Pragma(逐渐被抛弃) 和 Cahace-Contorl** 

```http
// no-cache 表示可以进行缓存，但是每次使用前都要和服务器进行确认，这个值容易和no-store混淆，no-store就是表示让浏然器不要缓存了，每次都像服务器请求资源
Cahace-Contorl :  no-cache 
// max-age 就表示资源的最长缓存时间，这里的单位是秒，在数值足够大的话，这表示资源是长期不需要改变的因此浏然器或者cdn都可以长期存储该资源
Cahace-Contorl :  max-age 1111111111


```

http 请求头其他缓存相关

+ etag：用来标识资源的，一般来说每一次资源更新后，etag的值也会被服务器更新。

+ Expries：表示缓存时间的首部，相当于缓存的过期时间，在过期事件没有到达之前都是认为资源未过期，因此不会和服务器要求更新资源，但是如果服务器的时间不同步，那时间就会出现误差，因此Expries经常和Last-modified配合使用

+ Last-modified：表示缓存时间的首部，表示资源最后修改时间，这样客户端下一次进行请求时就可以检查资源时间是否一致，如果一致就表示资源没有修改，如果不一致就得让服务器返回新的资源了
