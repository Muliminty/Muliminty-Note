# Gulp å¸¸ç”¨æ’ä»¶

> Gulp ç”Ÿæ€ç³»ç»Ÿä¸­å¸¸ç”¨çš„æ’ä»¶é›†åˆ

---

## ğŸ“‹ ç›®å½•

- [JavaScript å¤„ç†æ’ä»¶](#javascript-å¤„ç†æ’ä»¶)
- [CSS å¤„ç†æ’ä»¶](#css-å¤„ç†æ’ä»¶)
- [HTML å¤„ç†æ’ä»¶](#html-å¤„ç†æ’ä»¶)
- [å›¾ç‰‡å¤„ç†æ’ä»¶](#å›¾ç‰‡å¤„ç†æ’ä»¶)
- [æ–‡ä»¶æ“ä½œæ’ä»¶](#æ–‡ä»¶æ“ä½œæ’ä»¶)
- [å¼€å‘å·¥å…·æ’ä»¶](#å¼€å‘å·¥å…·æ’ä»¶)
- [å…¶ä»–å®ç”¨æ’ä»¶](#å…¶ä»–å®ç”¨æ’ä»¶)

---

## JavaScript å¤„ç†æ’ä»¶

### gulp-uglify

JavaScript å‹ç¼©æ’ä»¶

```bash
npm install --save-dev gulp-uglify
```

```javascript
const uglify = require('gulp-uglify');

function scripts() {
  return src('src/js/*.js')
    .pipe(uglify())
    .pipe(dest('dist/js'));
}

// é€‰é¡¹
uglify({
  mangle: true,              // æ··æ·†å˜é‡å
  compress: {
    drop_console: true       // ç§»é™¤ console
  }
})
```

### gulp-babel

ES6+ è½¬ ES5

```bash
npm install --save-dev gulp-babel @babel/core @babel/preset-env
```

```javascript
const babel = require('gulp-babel');

function scripts() {
  return src('src/js/*.js')
    .pipe(babel({
      presets: ['@babel/preset-env']
    }))
    .pipe(dest('dist/js'));
}
```

### gulp-webpack

Webpack é›†æˆ

```bash
npm install --save-dev gulp-webpack webpack
```

```javascript
const webpack = require('gulp-webpack');

function scripts() {
  return src('src/js/app.js')
    .pipe(webpack({
      mode: 'production',
      output: {
        filename: 'app.bundle.js'
      }
    }))
    .pipe(dest('dist/js'));
}
```

### gulp-eslint

ESLint ä»£ç æ£€æŸ¥

```bash
npm install --save-dev gulp-eslint
```

```javascript
const eslint = require('gulp-eslint');

function lint() {
  return src(['src/js/**/*.js'])
    .pipe(eslint())
    .pipe(eslint.format())
    .pipe(eslint.failAfterError());
}
```

### gulp-sourcemaps

ç”Ÿæˆ Source Map

```bash
npm install --save-dev gulp-sourcemaps
```

```javascript
const sourcemaps = require('gulp-sourcemaps');

function scripts() {
  return src('src/js/*.js')
    .pipe(sourcemaps.init())
    .pipe(uglify())
    .pipe(sourcemaps.write('.'))
    .pipe(dest('dist/js'));
}
```

### gulp-concat

æ–‡ä»¶åˆå¹¶

```bash
npm install --save-dev gulp-concat
```

```javascript
const concat = require('gulp-concat');

function scripts() {
  return src('src/js/*.js')
    .pipe(concat('app.js'))
    .pipe(dest('dist/js'));
}
```

---

## CSS å¤„ç†æ’ä»¶

### gulp-sass

Sass ç¼–è¯‘

```bash
npm install --save-dev gulp-sass sass
```

```javascript
const sass = require('gulp-sass')(require('sass'));

function styles() {
  return src('src/scss/*.scss')
    .pipe(sass().on('error', sass.logError))
    .pipe(dest('dist/css'));
}
```

### gulp-less

Less ç¼–è¯‘

```bash
npm install --save-dev gulp-less
```

```javascript
const less = require('gulp-less');

function styles() {
  return src('src/less/*.less')
    .pipe(less())
    .pipe(dest('dist/css'));
}
```

### gulp-postcss

PostCSS å¤„ç†

```bash
npm install --save-dev gulp-postcss autoprefixer cssnano
```

```javascript
const postcss = require('gulp-postcss');
const autoprefixer = require('autoprefixer');
const cssnano = require('cssnano');

function styles() {
  return src('src/css/*.css')
    .pipe(postcss([
      autoprefixer(),
      cssnano()
    ]))
    .pipe(dest('dist/css'));
}
```

### gulp-clean-css

CSS å‹ç¼©

```bash
npm install --save-dev gulp-clean-css
```

```javascript
const cleanCSS = require('gulp-clean-css');

function styles() {
  return src('src/css/*.css')
    .pipe(cleanCSS())
    .pipe(dest('dist/css'));
}
```

---

## HTML å¤„ç†æ’ä»¶

### gulp-htmlmin

HTML å‹ç¼©

```bash
npm install --save-dev gulp-htmlmin
```

```javascript
const htmlmin = require('gulp-htmlmin');

function html() {
  return src('src/*.html')
    .pipe(htmlmin({
      collapseWhitespace: true,
      removeComments: true,
      minifyCSS: true,
      minifyJS: true
    }))
    .pipe(dest('dist/'));
}
```

### gulp-pug

Pug æ¨¡æ¿ç¼–è¯‘

```bash
npm install --save-dev gulp-pug
```

```javascript
const pug = require('gulp-pug');

function html() {
  return src('src/pug/*.pug')
    .pipe(pug({
      pretty: true
    }))
    .pipe(dest('dist/'));
}
```

### gulp-file-include

HTML æ–‡ä»¶åŒ…å«

```bash
npm install --save-dev gulp-file-include
```

```javascript
const fileInclude = require('gulp-file-include');

function html() {
  return src('src/*.html')
    .pipe(fileInclude({
      prefix: '@@',
      basepath: '@file'
    }))
    .pipe(dest('dist/'));
}
```

### gulp-nunjucks

Nunjucks æ¨¡æ¿ç¼–è¯‘

```bash
npm install --save-dev gulp-nunjucks
```

```javascript
const nunjucks = require('gulp-nunjucks');

function html() {
  return src('src/templates/*.html')
    .pipe(nunjucks.compile({
      name: 'World'
    }))
    .pipe(dest('dist/'));
}
```

---

## å›¾ç‰‡å¤„ç†æ’ä»¶

### gulp-imagemin

å›¾ç‰‡å‹ç¼©

```bash
npm install --save-dev gulp-imagemin
```

```javascript
const imagemin = require('gulp-imagemin');

function images() {
  return src('src/images/**/*')
    .pipe(imagemin([
      imagemin.gifsicle({ interlaced: true }),
      imagemin.mozjpeg({ quality: 75, progressive: true }),
      imagemin.optipng({ optimizationLevel: 5 }),
      imagemin.svgo({
        plugins: [
          { removeViewBox: true },
          { cleanupIDs: false }
        ]
      })
    ]))
    .pipe(dest('dist/images'));
}
```

### gulp-webp

WebP è½¬æ¢

```bash
npm install --save-dev gulp-webp
```

```javascript
const webp = require('gulp-webp');

function webpImages() {
  return src('src/images/**/*.{jpg,png}')
    .pipe(webp({
      quality: 85
    }))
    .pipe(dest('dist/images'));
}
```

### gulp-responsive

å“åº”å¼å›¾ç‰‡ç”Ÿæˆ

```bash
npm install --save-dev gulp-responsive
```

```javascript
const responsive = require('gulp-responsive');

function images() {
  return src('src/images/**/*.{jpg,png}')
    .pipe(responsive({
      '*.jpg': [
        { width: 320, rename: { suffix: '-small' } },
        { width: 640, rename: { suffix: '-medium' } },
        { width: 1024, rename: { suffix: '-large' } }
      ]
    }))
    .pipe(dest('dist/images'));
}
```

---

## æ–‡ä»¶æ“ä½œæ’ä»¶

### del

åˆ é™¤æ–‡ä»¶ï¼ˆGulp 4.x æ¨èä½¿ç”¨ï¼‰

```bash
npm install --save-dev del
```

```javascript
const del = require('del');

function clean() {
  return del(['dist/*']);
}
```

### gulp-rename

æ–‡ä»¶é‡å‘½å

```bash
npm install --save-dev gulp-rename
```

```javascript
const rename = require('gulp-rename');

function scripts() {
  return src('src/js/app.js')
    .pipe(uglify())
    .pipe(rename({
      suffix: '.min',
      extname: '.js'
    }))
    .pipe(dest('dist/js'));
}
```

### gulp-filter

æ–‡ä»¶è¿‡æ»¤

```bash
npm install --save-dev gulp-filter
```

```javascript
const filter = require('gulp-filter');

function scripts() {
  const jsFilter = filter('**/*.js', { restore: true });
  
  return src('src/**/*')
    .pipe(jsFilter)
    .pipe(uglify())
    .pipe(jsFilter.restore)
    .pipe(dest('dist/'));
}
```

### gulp-if

æ¡ä»¶åˆ¤æ–­

```bash
npm install --save-dev gulp-if
```

```javascript
const gulpif = require('gulp-if');
const { argv } = require('yargs');

function scripts() {
  return src('src/js/*.js')
    .pipe(gulpif(argv.production, uglify()))
    .pipe(dest('dist/js'));
}
```

---

## å¼€å‘å·¥å…·æ’ä»¶

### browser-sync

æµè§ˆå™¨åŒæ­¥

```bash
npm install --save-dev browser-sync
```

```javascript
const browserSync = require('browser-sync').create();

function server() {
  browserSync.init({
    server: {
      baseDir: './dist'
    },
    port: 3000
  });
}

function reload(cb) {
  browserSync.reload();
  cb();
}
```

### gulp-connect

æœ¬åœ°æœåŠ¡å™¨

```bash
npm install --save-dev gulp-connect
```

```javascript
const connect = require('gulp-connect');

function server() {
  connect.server({
    root: 'dist',
    port: 8080,
    livereload: true
  });
}
```

### gulp-plumber

é”™è¯¯å¤„ç†ï¼ˆé˜²æ­¢ç®¡é“ä¸­æ–­ï¼‰

```bash
npm install --save-dev gulp-plumber
```

```javascript
const plumber = require('gulp-plumber');

function scripts() {
  return src('src/js/*.js')
    .pipe(plumber())  // é˜²æ­¢é”™è¯¯ä¸­æ–­
    .pipe(babel())
    .pipe(uglify())
    .pipe(dest('dist/js'));
}
```

### gulp-notify

ç³»ç»Ÿé€šçŸ¥

```bash
npm install --save-dev gulp-notify
```

```javascript
const notify = require('gulp-notify');

function scripts() {
  return src('src/js/*.js')
    .pipe(babel())
    .on('error', notify.onError('Error: <%= error.message %>'))
    .pipe(dest('dist/js'));
}
```

---

## å…¶ä»–å®ç”¨æ’ä»¶

### gulp-size

æ˜¾ç¤ºæ–‡ä»¶å¤§å°

```bash
npm install --save-dev gulp-size
```

```javascript
const size = require('gulp-size');

function scripts() {
  return src('src/js/*.js')
    .pipe(uglify())
    .pipe(size({
      showFiles: true,
      showTotal: false
    }))
    .pipe(dest('dist/js'));
}
```

### gulp-util

Gulp å·¥å…·å‡½æ•°

```bash
npm install --save-dev gulp-util
```

```javascript
const gutil = require('gulp-util');

function scripts() {
  if (gutil.env.production) {
    return src('src/js/*.js')
      .pipe(uglify())
      .pipe(dest('dist/js'));
  } else {
    return src('src/js/*.js')
      .pipe(dest('dist/js'));
  }
}
```

### gulp-changed

åªå¤„ç†ä¿®æ”¹è¿‡çš„æ–‡ä»¶

```bash
npm install --save-dev gulp-changed
```

```javascript
const changed = require('gulp-changed');

function images() {
  return src('src/images/**/*')
    .pipe(changed('dist/images'))
    .pipe(imagemin())
    .pipe(dest('dist/images'));
}
```

### gulp-newer

åªå¤„ç†æ–°æ–‡ä»¶

```bash
npm install --save-dev gulp-newer
```

```javascript
const newer = require('gulp-newer');

function images() {
  return src('src/images/**/*')
    .pipe(newer('dist/images'))
    .pipe(imagemin())
    .pipe(dest('dist/images'));
}
```

### gulp-debug

è°ƒè¯•è¾“å‡º

```bash
npm install --save-dev gulp-debug
```

```javascript
const debug = require('gulp-debug');

function scripts() {
  return src('src/js/*.js')
    .pipe(debug({ title: 'scripts:' }))
    .pipe(uglify())
    .pipe(dest('dist/js'));
}
```

---

## ğŸ“š ç›¸å…³é“¾æ¥

- [Gulp å®˜æ–¹æ’ä»¶åº“](https://gulpjs.com/plugins/)
- [npm æœç´¢ gulp-plugin](https://www.npmjs.com/search?q=gulp-plugin)
- [Awesome Gulp](https://github.com/alferov/awesome-gulp)

---

**æ ‡ç­¾**: #gulp #æ’ä»¶ #æ„å»ºå·¥å…· #å·¥ç¨‹åŒ–
