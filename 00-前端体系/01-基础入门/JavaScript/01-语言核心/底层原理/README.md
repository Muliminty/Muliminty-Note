# 底层原理（Underlying Mechanisms）

> JavaScript 引擎执行代码的底层机制：执行上下文、调用栈、内存管理、V8 工作原理、事件循环机制
> 
> **学习路径**：
> - 📖 **先学执行上下文**：理解 JavaScript 代码的执行环境
> - 🚀 **再学调用栈**：理解函数调用的管理机制
> - 💾 **学习内存管理**：理解数据存储和垃圾回收
> - ⚙️ **了解 V8 工作原理**：理解代码编译和执行流程
> - 🔄 **掌握事件循环**：理解异步任务的执行机制

---

## 📚 目录

### 核心概念

#### 1. 执行上下文（Execution Context）
- [执行上下文（Execution Context）](./执行上下文.md) — 执行上下文的创建、变量环境、词法环境
  - 变量环境（Variable Environment）与全局对象的关系
  - 词法环境（Lexical Environment）的结构和作用
  - 执行上下文的生命周期
  - 变量提升的底层机制
  - 编译阶段和执行阶段

#### 2. 调用栈（Call Stack）
- [调用栈（Call Stack）](./调用栈.md) — 函数调用的管理机制
  - 调用栈的概念和结构
  - 函数调用的执行流程
  - 栈溢出的原因和解决方案
  - 调试技巧：查看调用栈信息

#### 3. 内存管理（Memory Management）
- [内存管理（Memory Management）](./内存管理.md) — 数据存储和垃圾回收
  - 栈空间和堆空间
  - 原始类型和引用类型的存储
  - 垃圾回收机制
  - 闭包的内存模型

#### 4. V8 工作原理（V8 Engine）
- [V8 工作原理（V8 Engine）](./V8工作原理.md) — 代码编译和执行流程
  - 编译器和解释器
  - 抽象语法树（AST）
  - 字节码和即时编译（JIT）
  - 代码执行流程

#### 5. 事件循环机制（Event Loop）
- [事件循环机制（Event Loop）](./事件循环机制.md) — 异步任务的执行机制
  - 消息队列和事件循环
  - 宏任务和微任务
  - Promise 和 async/await 的实现原理
  - 任务调度的优先级

---

## 🎯 学习路径

### 第一阶段：理解执行上下文和调用栈

**目标**：理解 JavaScript 代码的执行环境和函数调用机制。

**学习顺序**：
1. [执行上下文](./执行上下文.md) — **先学这个**，理解执行环境、变量环境、词法环境
2. [调用栈](./调用栈.md) — 理解函数调用的管理机制

**核心概念**：
- ✅ 执行上下文的创建和执行过程
- ✅ 变量环境与词法环境的区别
- ✅ `var` 如何添加到全局对象，`let`/`const` 为什么不会
- ✅ 变量提升和 TDZ 的底层机制
- ✅ 调用栈如何管理函数调用
- ✅ 栈溢出的原因和解决方案

---

### 第二阶段：理解内存管理

**目标**：理解数据在内存中的存储方式和垃圾回收机制。

**学习顺序**：
1. [内存管理](./内存管理.md) — 理解栈空间、堆空间、垃圾回收

**核心概念**：
- ✅ 栈空间和堆空间的区别
- ✅ 原始类型和引用类型的存储方式
- ✅ 闭包的内存模型
- ✅ 垃圾回收的算法和策略
- ✅ 内存泄漏的原因和预防

---

### 第三阶段：理解 V8 工作原理

**目标**：理解 JavaScript 引擎如何编译和执行代码。

**学习顺序**：
1. [V8 工作原理](./V8工作原理.md) — 理解编译器和解释器、AST、字节码、JIT

**核心概念**：
- ✅ 编译型和解释型语言的区别
- ✅ 抽象语法树（AST）的生成过程
- ✅ 字节码的作用和优势
- ✅ 即时编译（JIT）的工作原理
- ✅ V8 的执行流程

---

### 第四阶段：理解事件循环机制

**目标**：理解异步任务的执行机制和任务调度。

**学习顺序**：
1. [事件循环机制](./事件循环机制.md) — 理解消息队列、宏任务、微任务、Promise、async/await

**核心概念**：
- ✅ 消息队列和事件循环的工作原理
- ✅ 宏任务和微任务的区别
- ✅ Promise 的底层实现
- ✅ async/await 的实现原理（生成器和协程）
- ✅ 任务调度的优先级

---

## 📖 学习建议

### 对于初学者

1. **先学执行上下文**：这是理解其他概念的基础
2. **循序渐进**：按照学习路径逐步深入
3. **结合实践**：通过编写代码来验证理解
4. **调试工具**：使用 Chrome DevTools 查看执行上下文和调用栈

### 对于进阶学习者

1. **深入原理**：理解每个机制的底层实现
2. **性能优化**：基于原理知识进行性能优化
3. **问题排查**：从原理层面分析和解决问题
4. **源码阅读**：阅读 V8 引擎源码加深理解

---

## 🔗 相关链接

### 前置知识
- [变量声明](../变量声明.md) — 变量声明的使用和原理
- [作用域和闭包](../作用域和闭包.md) — 作用域和闭包的概念
- [函数](../函数.md) — 函数的执行机制

### 进阶学习
- [异步编程](../04-异步编程/README.md) — 异步处理机制
- [性能优化](../06-性能优化/README.md) — 性能优化技巧

### 外部资源
- [浏览器工作原理与实践](https://blog.poetries.top/browser-working-principle/) — 李兵老师的系列文章
- [V8 引擎博客](https://v8.dev/) — V8 官方博客
- [ECMAScript 规范](https://tc39.es/ecma262/) — ECMAScript 语言规范

---

#javascript #底层原理 #执行上下文 #调用栈 #内存管理 #V8引擎 #事件循环
