# ç®­å¤´å‡½æ•°ï¼ˆArrow Functionsï¼‰

ES6 å¼•å…¥çš„ç®€åŒ–å‡½æ•°è¯­æ³•ï¼Œå¹¶æ”¹å˜ `this` ç»‘å®šè¡Œä¸ºã€‚

---

## ğŸ“š åŸºæœ¬è¯­æ³•

### åŸºæœ¬å½¢å¼

```javascript
// ä¼ ç»Ÿå‡½æ•°
function add(a, b) {
  return a + b;
}

// ç®­å¤´å‡½æ•°
const add = (a, b) => {
  return a + b;
};

// ç®€åŒ–å½¢å¼ï¼ˆå•è¡¨è¾¾å¼ï¼‰
const add = (a, b) => a + b;
```

### å‚æ•°

```javascript
// å•ä¸ªå‚æ•°ï¼ˆå¯çœç•¥æ‹¬å·ï¼‰
const square = x => x * x;

// å¤šä¸ªå‚æ•°ï¼ˆå¿…é¡»æ‹¬å·ï¼‰
const add = (a, b) => a + b;

// æ— å‚æ•°ï¼ˆå¿…é¡»æ‹¬å·ï¼‰
const greet = () => 'Hello';
```

### å‡½æ•°ä½“

```javascript
// å•è¡¨è¾¾å¼ï¼ˆè‡ªåŠ¨è¿”å›ï¼‰
const double = x => x * 2;

// å¤šè¯­å¥ï¼ˆéœ€è¦å¤§æ‹¬å·å’Œ returnï¼‰
const process = x => {
  const doubled = x * 2;
  return doubled + 1;
};
```

---

## ğŸ¯ ç‰¹æ€§

### 1. ä¸ç»‘å®š this

ç®­å¤´å‡½æ•°ä¸ç»‘å®šè‡ªå·±çš„ `this`ï¼Œç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸçš„ `this`ï¼š

```javascript
const person = {
  name: 'Alice',
  greet: function() {
    setTimeout(() => {
      console.log(`Hello, I'm ${this.name}`); // this æŒ‡å‘ person
    }, 100);
  }
};

person.greet(); // "Hello, I'm Alice"
```

å¯¹æ¯”æ™®é€šå‡½æ•°ï¼š

```javascript
const person = {
  name: 'Alice',
  greet: function() {
    setTimeout(function() {
      console.log(`Hello, I'm ${this.name}`); // this æŒ‡å‘ window
    }, 100);
  }
};

person.greet(); // "Hello, I'm undefined"
```

### 2. ä¸ç»‘å®š arguments

```javascript
function traditional() {
  console.log(arguments); // ç±»æ•°ç»„å¯¹è±¡
}

const arrow = () => {
  console.log(arguments); // ReferenceError
};

// ä½¿ç”¨å‰©ä½™å‚æ•°
const arrow = (...args) => {
  console.log(args); // æ•°ç»„
};
```

### 3. ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°

```javascript
// âŒ é”™è¯¯ï¼šç®­å¤´å‡½æ•°ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°
const Person = (name) => {
  this.name = name;
};
const person = new Person('Alice'); // TypeError

// âœ… æ­£ç¡®ï¼šä½¿ç”¨æ™®é€šå‡½æ•°
function Person(name) {
  this.name = name;
}
const person = new Person('Alice');
```

### 4. æ²¡æœ‰ prototype

```javascript
const arrow = () => {};
console.log(arrow.prototype); // undefined

function traditional() {}
console.log(traditional.prototype); // { constructor: f }
```

---

## ğŸ’¡ ä½¿ç”¨åœºæ™¯

### 1. æ•°ç»„æ–¹æ³•

```javascript
const numbers = [1, 2, 3, 4];
const doubled = numbers.map(n => n * 2);
const evens = numbers.filter(n => n % 2 === 0);
const sum = numbers.reduce((acc, n) => acc + n, 0);
```

### 2. å›è°ƒå‡½æ•°

```javascript
// äº‹ä»¶å¤„ç†
button.addEventListener('click', () => {
  console.log('Button clicked');
});

// Promise
fetch('/api/data')
  .then(response => response.json())
  .then(data => console.log(data));
```

### 3. ä¿æŒ this ä¸Šä¸‹æ–‡

```javascript
class Counter {
  constructor() {
    this.count = 0;
  }
  
  increment() {
    // ç®­å¤´å‡½æ•°ä¿æŒ this
    setInterval(() => {
      this.count++;
      console.log(this.count);
    }, 1000);
  }
}
```

### 4. å‡½æ•°å¼ç¼–ç¨‹

```javascript
const compose = (...fns) => x => fns.reduceRight((acc, fn) => fn(acc), x);
const pipe = (...fns) => x => fns.reduce((acc, fn) => fn(acc), x);
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ä¸é€‚åˆä½œä¸ºå¯¹è±¡æ–¹æ³•

```javascript
const obj = {
  name: 'Alice',
  greet: () => {
    console.log(`Hello, I'm ${this.name}`); // this æŒ‡å‘å¤–å±‚
  }
};

obj.greet(); // "Hello, I'm undefined"
```

### 2. ä¸èƒ½ä½¿ç”¨ call/apply/bind æ”¹å˜ this

```javascript
const arrow = () => console.log(this);
const obj = { name: 'Alice' };

arrow.call(obj); // this ä»ç„¶æ˜¯å¤–å±‚ä½œç”¨åŸŸçš„ this
```

### 3. ä¸é€‚åˆéœ€è¦åŠ¨æ€ this çš„åœºæ™¯

```javascript
// âŒ ä¸é€‚åˆï¼šéœ€è¦åŠ¨æ€ this
const button = document.querySelector('button');
button.addEventListener('click', () => {
  // this ä¸æ˜¯ button
  console.log(this); // window
});

// âœ… é€‚åˆï¼šä½¿ç”¨æ™®é€šå‡½æ•°
button.addEventListener('click', function() {
  console.log(this); // button
});
```

---

## ğŸ”„ ä¸ä¼ ç»Ÿå‡½æ•°å¯¹æ¯”

| ç‰¹æ€§ | ç®­å¤´å‡½æ•° | ä¼ ç»Ÿå‡½æ•° |
|------|---------|---------|
| this ç»‘å®š | ç»§æ‰¿å¤–å±‚ | åŠ¨æ€ç»‘å®š |
| arguments | æ—  | æœ‰ |
| æ„é€ å‡½æ•° | ä¸èƒ½ | èƒ½ |
| prototype | æ—  | æœ‰ |
| è¯­æ³• | ç®€æ´ | å®Œæ•´ |

---

## ğŸ”— ç›¸å…³é“¾æ¥

- [é«˜é˜¶å‡½æ•°](./01-é«˜é˜¶å‡½æ•°.md) â€” é«˜é˜¶å‡½æ•°è¯¦è§£
- [this ç»‘å®š](../05-å¯¹è±¡ä¸ç±»/04-thisç»‘å®š.md) â€” this ç»‘å®šè§„åˆ™
- [ä¸å¯å˜æ•°æ®](./03-ä¸å¯å˜æ•°æ®.md) â€” ä¸å¯å˜æ•°æ®æ¨¡å¼

---

**å‚è€ƒ**ï¼š
- [MDN: Arrow functions](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions)
- [ECMAScript Arrow Functions](https://tc39.es/ecma262/#sec-arrow-function-definitions)

---

#javascript #ç®­å¤´å‡½æ•° #arrow-function #å‡½æ•°å¼ç¼–ç¨‹
