# ä»£ç æ€§èƒ½ä¼˜åŒ–ï¼ˆCode Performance Optimizationï¼‰

ä»£ç å±‚é¢çš„æ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€‚

---

## ğŸ“š ä¼˜åŒ–ç­–ç•¥

### 1. å‡å°‘ DOM æ“ä½œ

```javascript
// âŒ é”™è¯¯ï¼šé¢‘ç¹æ“ä½œ DOM
for (let i = 0; i < 1000; i++) {
  document.getElementById('list').innerHTML += `<li>Item ${i}</li>`;
}

// âœ… æ­£ç¡®ï¼šæ‰¹é‡æ“ä½œ
const fragment = document.createDocumentFragment();
for (let i = 0; i < 1000; i++) {
  const li = document.createElement('li');
  li.textContent = `Item ${i}`;
  fragment.appendChild(li);
}
document.getElementById('list').appendChild(fragment);
```

### 2. ä½¿ç”¨äº‹ä»¶å§”æ‰˜

```javascript
// âŒ é”™è¯¯ï¼šä¸ºæ¯ä¸ªå…ƒç´ ç»‘å®šäº‹ä»¶
items.forEach(item => {
  item.addEventListener('click', handleClick);
});

// âœ… æ­£ç¡®ï¼šäº‹ä»¶å§”æ‰˜
container.addEventListener('click', (e) => {
  if (e.target.matches('.item')) {
    handleClick(e.target);
  }
});
```

### 3. é˜²æŠ–å’ŒèŠ‚æµ

```javascript
// é˜²æŠ–ï¼šå»¶è¿Ÿæ‰§è¡Œ
function debounce(fn, delay) {
  let timeoutId;
  return function(...args) {
    clearTimeout(timeoutId);
    timeoutId = setTimeout(() => fn.apply(this, args), delay);
  };
}

// èŠ‚æµï¼šé™åˆ¶æ‰§è¡Œé¢‘ç‡
function throttle(fn, delay) {
  let lastCall = 0;
  return function(...args) {
    const now = Date.now();
    if (now - lastCall >= delay) {
      lastCall = now;
      return fn.apply(this, args);
    }
  };
}
```

### 4. é¿å…å…¨å±€æŸ¥æ‰¾

```javascript
// âŒ é”™è¯¯ï¼šé‡å¤æŸ¥æ‰¾
function process() {
  for (let i = 0; i < items.length; i++) {
    document.getElementById('result').innerHTML += items[i];
  }
}

// âœ… æ­£ç¡®ï¼šç¼“å­˜æŸ¥æ‰¾ç»“æœ
function process() {
  const result = document.getElementById('result');
  const itemsLength = items.length;
  for (let i = 0; i < itemsLength; i++) {
    result.innerHTML += items[i];
  }
}
```

### 5. ä½¿ç”¨åˆé€‚çš„å¾ªç¯

```javascript
// for å¾ªç¯é€šå¸¸æœ€å¿«
for (let i = 0; i < array.length; i++) {
  // å¤„ç†
}

// for...of å¯è¯»æ€§å¥½
for (const item of array) {
  // å¤„ç†
}

// forEach å‡½æ•°å¼ï¼Œä½†è¾ƒæ…¢
array.forEach(item => {
  // å¤„ç†
});
```

### 6. ä¼˜åŒ–æ¡ä»¶åˆ¤æ–­

```javascript
// âœ… å°†æœ€å¯èƒ½ä¸ºçœŸçš„æ¡ä»¶æ”¾åœ¨å‰é¢
if (likelyCondition) {
  // å¤„ç†
} else if (unlikelyCondition) {
  // å¤„ç†
}

// âœ… ä½¿ç”¨ switch å¤„ç†å¤šä¸ªæ¡ä»¶
switch (value) {
  case 'a':
    // å¤„ç†
    break;
  case 'b':
    // å¤„ç†
    break;
}
```

### 7. ä½¿ç”¨ Web Workers

```javascript
// ä¸»çº¿ç¨‹
const worker = new Worker('worker.js');
worker.postMessage({ data: largeData });
worker.onmessage = (e) => {
  console.log('Result:', e.data);
};

// worker.js
self.onmessage = (e) => {
  const result = processLargeData(e.data.data);
  self.postMessage(result);
};
```

### 8. æ‡’åŠ è½½å’Œä»£ç åˆ†å‰²

```javascript
// åŠ¨æ€å¯¼å…¥
const module = await import('./heavy-module.js');

// React æ‡’åŠ è½½
const HeavyComponent = lazy(() => import('./HeavyComponent'));
```

---

## ğŸ’¡ æ•°æ®ç»“æ„ä¼˜åŒ–

### 1. é€‰æ‹©åˆé€‚çš„é›†åˆ

```javascript
// Set ç”¨äºå¿«é€ŸæŸ¥æ‰¾
const uniqueItems = new Set(items);

// Map ç”¨äºé”®å€¼å¯¹
const cache = new Map();

// Array ç”¨äºæœ‰åºåˆ—è¡¨
const list = [];
```

### 2. é¿å…ä¸å¿…è¦çš„æ•°ç»„æ“ä½œ

```javascript
// âŒ é”™è¯¯ï¼šå¤šæ¬¡éå†
const doubled = numbers.map(n => n * 2);
const filtered = doubled.filter(n => n > 10);
const sum = filtered.reduce((a, b) => a + b, 0);

// âœ… æ­£ç¡®ï¼šä¸€æ¬¡éå†
let sum = 0;
for (const n of numbers) {
  const doubled = n * 2;
  if (doubled > 10) {
    sum += doubled;
  }
}
```

---

## ğŸ”§ ç®—æ³•ä¼˜åŒ–

### 1. ä½¿ç”¨åˆé€‚çš„ç®—æ³•

```javascript
// æŸ¥æ‰¾ï¼šä½¿ç”¨ Map è€Œä¸æ˜¯æ•°ç»„
const map = new Map();
map.set('key', 'value');
map.get('key'); // O(1)

// æ’åºï¼šä½¿ç”¨åŸç”Ÿ sort
array.sort((a, b) => a - b);
```

### 2. ç¼“å­˜è®¡ç®—ç»“æœ

```javascript
// è®°å¿†åŒ–
function memoize(fn) {
  const cache = new Map();
  return function(...args) {
    const key = JSON.stringify(args);
    if (cache.has(key)) {
      return cache.get(key);
    }
    const result = fn.apply(this, args);
    cache.set(key, result);
    return result;
  };
}
```

---

## ğŸ”— ç›¸å…³é“¾æ¥

- [åƒåœ¾å›æ”¶æœºåˆ¶](./01-åƒåœ¾å›æ”¶æœºåˆ¶.md) â€” å†…å­˜ç®¡ç†
- [æ€§èƒ½ç›‘æ§ä¸åˆ†æ](./04-æ€§èƒ½ç›‘æ§ä¸åˆ†æ.md) â€” æ€§èƒ½åˆ†æå·¥å…·
- [æ€§èƒ½ä¼˜åŒ– MOC](../../04-è´¨é‡ä¿éšœ/æ€§èƒ½/!MOC-æ€§èƒ½.md) â€” æ€§èƒ½ä¼˜åŒ–å®Œæ•´æŒ‡å—

---

**å‚è€ƒ**ï¼š
- [MDN: Performance](https://developer.mozilla.org/zh-CN/docs/Web/Performance)
- [Web.dev: Performance](https://web.dev/performance/)

---

#javascript #æ€§èƒ½ä¼˜åŒ– #ä»£ç ä¼˜åŒ– #performance
