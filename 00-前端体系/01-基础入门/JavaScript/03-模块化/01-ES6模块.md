# ES6 æ¨¡å—ï¼ˆES Modulesï¼‰

ES6 æ¨¡å—ï¼ˆES Modulesï¼Œç®€ç§° ESMï¼‰æ˜¯ JavaScript çš„å®˜æ–¹æ¨¡å—ç³»ç»Ÿï¼Œä½¿ç”¨ `import` å’Œ `export` è¯­æ³•ã€‚

---

## ğŸ“š åŸºæœ¬è¯­æ³•

### export å¯¼å‡º

#### å‘½åå¯¼å‡ºï¼ˆNamed Exportï¼‰

```javascript
// math.js
export const PI = 3.14159;
export function add(a, b) {
  return a + b;
}
export class Calculator {
  multiply(a, b) {
    return a * b;
  }
}

// æˆ–è€…å…ˆå®šä¹‰åå¯¼å‡º
const PI = 3.14159;
function add(a, b) {
  return a + b;
}
export { PI, add };
```

#### é»˜è®¤å¯¼å‡ºï¼ˆDefault Exportï¼‰

```javascript
// utils.js
export default function formatDate(date) {
  return date.toISOString();
}

// æˆ–è€…
function formatDate(date) {
  return date.toISOString();
}
export default formatDate;
```

#### æ··åˆå¯¼å‡º

```javascript
// config.js
export const API_URL = 'https://api.example.com';
export default {
  timeout: 5000,
  retries: 3
};
```

---

### import å¯¼å…¥

#### å‘½åå¯¼å…¥

```javascript
// å¯¼å…¥å•ä¸ª
import { PI, add } from './math.js';

// å¯¼å…¥å…¨éƒ¨
import * as math from './math.js';
console.log(math.PI);
console.log(math.add(1, 2));

// é‡å‘½åå¯¼å…¥
import { add as sum } from './math.js';
```

#### é»˜è®¤å¯¼å…¥

```javascript
import formatDate from './utils.js';

// é»˜è®¤å¯¼å…¥å’Œå‘½åå¯¼å…¥æ··åˆ
import formatDate, { API_URL } from './config.js';
```

#### ä»…æ‰§è¡Œæ¨¡å—ï¼ˆä¸å¯¼å…¥ä»»ä½•å†…å®¹ï¼‰

```javascript
import './polyfills.js'; // æ‰§è¡Œæ¨¡å—ï¼Œä½†ä¸å¯¼å…¥ä»»ä½•å†…å®¹
```

---

## ğŸ” ç‰¹æ€§

### 1. é™æ€åˆ†æ

ES6 æ¨¡å—åœ¨ç¼–è¯‘æ—¶å°±èƒ½ç¡®å®šå¯¼å…¥å¯¼å‡ºå…³ç³»ï¼Œæ”¯æŒï¼š
- é™æ€åˆ†æ
- Tree shakingï¼ˆæ­»ä»£ç æ¶ˆé™¤ï¼‰
- æ›´å¥½çš„ IDE æ”¯æŒ

```javascript
// ç¼–è¯‘æ—¶å°±èƒ½ç¡®å®šå¯¼å…¥å…³ç³»
import { add } from './math.js'; // âœ… é™æ€å¯¼å…¥

// åŠ¨æ€å¯¼å…¥éœ€è¦ä½¿ç”¨ import()
const module = await import('./math.js'); // åŠ¨æ€å¯¼å…¥
```

### 2. ä¸¥æ ¼æ¨¡å¼

ES6 æ¨¡å—è‡ªåŠ¨å¯ç”¨ä¸¥æ ¼æ¨¡å¼ï¼š

```javascript
// æ— éœ€ 'use strict'
export function test() {
  x = 10; // âŒ æŠ¥é”™ï¼šx is not definedï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰
}
```

### 3. é¡¶å±‚ this

ES6 æ¨¡å—ä¸­ï¼Œé¡¶å±‚ `this` ä¸º `undefined`ï¼š

```javascript
console.log(this); // undefinedï¼ˆåœ¨æ¨¡å—ä¸­ï¼‰
```

### 4. å•æ¬¡æ‰§è¡Œ

æ¨¡å—åªæ‰§è¡Œä¸€æ¬¡ï¼Œå¤šæ¬¡å¯¼å…¥ä¼šå…±äº«åŒä¸€ä¸ªæ¨¡å—å®ä¾‹ï¼š

```javascript
// counter.js
let count = 0;
export function increment() {
  count++;
  return count;
}

// a.js
import { increment } from './counter.js';
increment(); // 1

// b.js
import { increment } from './counter.js';
increment(); // 2ï¼ˆå…±äº«åŒä¸€ä¸ª countï¼‰
```

---

## ğŸ“¦ æ¨¡å—è·¯å¾„

### ç›¸å¯¹è·¯å¾„

```javascript
import { add } from './math.js';        // å½“å‰ç›®å½•
import { utils } from '../utils.js';    // ä¸Šçº§ç›®å½•
import { config } from './config/index.js'; // å­ç›®å½•
```

### ç»å¯¹è·¯å¾„ï¼ˆéœ€è¦é…ç½®ï¼‰

```javascript
// éœ€è¦é…ç½®è·¯å¾„åˆ«åï¼ˆå¦‚ webpackã€vite ç­‰ï¼‰
import { utils } from '@/utils/index.js';
```

### åŒ…å¯¼å…¥

```javascript
import React from 'react';
import { debounce } from 'lodash';
```

---

## ğŸ”„ ä¸ CommonJS å¯¹æ¯”

| ç‰¹æ€§ | ES6 æ¨¡å— | CommonJS |
|------|----------|----------|
| åŠ è½½æ—¶æœº | ç¼–è¯‘æ—¶ | è¿è¡Œæ—¶ |
| å¯¼å‡ºæ–¹å¼ | `export` | `module.exports` |
| å¯¼å…¥æ–¹å¼ | `import` | `require` |
| é»˜è®¤å¯¼å‡º | `export default` | `module.exports =` |
| å‘½åå¯¼å‡º | `export { name }` | `exports.name =` |
| åŠ¨æ€å¯¼å…¥ | `import()` | `require()` |
| é¡¶å±‚ this | `undefined` | `module` |

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. æ–‡ä»¶æ‰©å±•å

```javascript
// âœ… æ¨èï¼šæ˜ç¡®æŒ‡å®š .js æ‰©å±•å
import { add } from './math.js';

// âš ï¸ æŸäº›ç¯å¢ƒå¯ä»¥ä¸å†™ï¼Œä½†ä¸æ¨è
import { add } from './math';
```

### 2. å¯¼å‡ºæ–¹å¼é€‰æ‹©

```javascript
// âœ… æ¨èï¼šä½¿ç”¨å‘½åå¯¼å‡ºï¼ˆæ›´æ˜ç¡®ï¼‰
export function add(a, b) { return a + b; }
export function subtract(a, b) { return a - b; }

// âš ï¸ é»˜è®¤å¯¼å‡ºç”¨äºå•ä¸€ä¸»è¦åŠŸèƒ½
export default class Calculator { }
```

### 3. å¯¼å…¥é¡ºåº

```javascript
// âœ… æ¨èé¡ºåºï¼šå¤–éƒ¨åº“ â†’ å†…éƒ¨æ¨¡å— â†’ ç›¸å¯¹è·¯å¾„
import React from 'react';
import { utils } from '@/utils';
import { add } from './math.js';
```

### 4. é¿å…å¾ªç¯ä¾èµ–

```javascript
// âŒ é¿å…å¾ªç¯ä¾èµ–
// a.js
import { b } from './b.js';
export const a = 'a';

// b.js
import { a } from './a.js'; // å¯èƒ½å¯¼è‡´é—®é¢˜
export const b = 'b';
```

---

## ğŸ”— ç›¸å…³é“¾æ¥

- [åŠ¨æ€å¯¼å…¥](./03-åŠ¨æ€å¯¼å…¥.md) â€” `import()` åŠ¨æ€å¯¼å…¥
- [æ¨¡å—åŒ–å†å²](./04-æ¨¡å—åŒ–å†å².md) â€” CommonJSã€AMDã€UMD ç­‰
- [å¯¼å…¥å¯¼å‡º](./02-å¯¼å…¥å¯¼å‡º.md) â€” å¯¼å…¥å¯¼å‡ºè¯¦ç»†è¯´æ˜

---

**å‚è€ƒ**ï¼š
- [ECMAScript Modules](https://tc39.es/ecma262/#sec-modules)
- [MDN: import](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/import)
- [MDN: export](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/export)

---

#javascript #æ¨¡å—åŒ– #es-modules #es6
