# GSAP æ€§èƒ½ä¼˜åŒ–

> GSAP æ€§èƒ½ä¼˜åŒ–æŠ€å·§ï¼Œç¡®ä¿åŠ¨ç”»æµç•…è¿è¡Œåœ¨ 60fpsã€‚

---

## ğŸ“š æ€§èƒ½ä¼˜åŒ–åŸåˆ™

### 60fps ç›®æ ‡

- **å¸§ç‡**ï¼š60fps = æ¯å¸§ 16.67ms
- **ç›®æ ‡**ï¼šä¿æŒåŠ¨ç”»æµç•…ï¼Œé¿å…å¡é¡¿
- **ç›‘æ§**ï¼šä½¿ç”¨æµè§ˆå™¨ DevTools ç›‘æ§æ€§èƒ½

### æ€§èƒ½å½±å“å› ç´ 

1. **å±æ€§é€‰æ‹©**ï¼štransform å’Œ opacity æ€§èƒ½æœ€å¥½
2. **åŠ¨ç”»æ•°é‡**ï¼šåŒæ—¶è¿è¡Œçš„åŠ¨ç”»æ•°é‡
3. **å…ƒç´ æ•°é‡**ï¼šåŠ¨ç”»å…ƒç´ çš„æ•°é‡
4. **é‡æ’é‡ç»˜**ï¼šé¿å…è§¦å‘å¸ƒå±€å’Œç»˜åˆ¶

---

## ğŸ¯ å±æ€§ä¼˜åŒ–

### GPU åŠ é€Ÿå±æ€§

âœ… **æ¨èä½¿ç”¨**ï¼šè¿™äº›å±æ€§ç”± GPU å¤„ç†ï¼Œæ€§èƒ½æœ€ä½³

```javascript
// Transform å±æ€§
gsap.to(".box", {
  x: 100,           // translateX
  y: 50,            // translateY
  z: 0,             // translateZ
  rotation: 360,    // rotateZ
  rotationX: 180,   // rotateX
  rotationY: 90,    // rotateY
  scale: 1.5,       // scale
  scaleX: 2,        // scaleX
  scaleY: 0.5,      // scaleY
  skewX: 45,        // skewX
  skewY: 30,        // skewY
  opacity: 0.5      // opacity
});
```

### è§¦å‘é‡æ’çš„å±æ€§

âŒ **é¿å…ä½¿ç”¨**ï¼šè¿™äº›å±æ€§ä¼šè§¦å‘é‡æ’ï¼Œæ€§èƒ½è¾ƒå·®

```javascript
// âŒ ä¸æ¨è
gsap.to(".box", {
  left: "100px",      // è§¦å‘é‡æ’
  top: "50px",        // è§¦å‘é‡æ’
  width: "200px",     // è§¦å‘é‡æ’
  height: "100px",    // è§¦å‘é‡æ’
  margin: "20px",     // è§¦å‘é‡æ’
  padding: "10px"     // è§¦å‘é‡æ’
});

// âœ… æ¨èï¼šä½¿ç”¨ transform
gsap.to(".box", {
  x: 100,    // translateX
  y: 50      // translateY
});
```

### é¢œè‰²å’Œæ»¤é•œ

âš ï¸ **è°¨æ…ä½¿ç”¨**ï¼šè¿™äº›å±æ€§å¯èƒ½è§¦å‘é‡ç»˜

```javascript
// é¢œè‰²åŠ¨ç”»ï¼ˆéœ€è¦ ColorPropsPluginï¼‰
gsap.to(".box", {
  backgroundColor: "#ff0000",
  color: "#ffffff"
});

// æ»¤é•œåŠ¨ç”»ï¼ˆæ€§èƒ½è¾ƒå·®ï¼‰
gsap.to(".box", {
  filter: "blur(10px)",
  backdropFilter: "blur(10px)"
});
```

---

## ğŸ¨ will-change ä¼˜åŒ–

### ä½¿ç”¨ will-change

```css
.animated-element {
  will-change: transform, opacity;
}
```

### åŠ¨æ€è®¾ç½® will-change

```javascript
// åŠ¨ç”»å¼€å§‹å‰
gsap.set(".box", { willChange: "transform" });

// åŠ¨ç”»å®Œæˆåç§»é™¤
gsap.to(".box", {
  x: 100,
  duration: 1,
  onComplete: function() {
    gsap.set(".box", { willChange: "auto" });
  }
});
```

---

## ğŸš€ æ‰¹é‡æ“ä½œä¼˜åŒ–

### ä½¿ç”¨ Timeline è€Œä¸æ˜¯å¤šä¸ªç‹¬ç«‹åŠ¨ç”»

```javascript
// âŒ ä¸æ¨èï¼šå¤šä¸ªç‹¬ç«‹åŠ¨ç”»
gsap.to(".box1", { x: 100, duration: 1 });
gsap.to(".box2", { y: 100, duration: 1 });
gsap.to(".box3", { rotation: 360, duration: 1 });

// âœ… æ¨èï¼šä½¿ç”¨ Timeline
const tl = gsap.timeline();
tl.to(".box1", { x: 100, duration: 1 })
  .to(".box2", { y: 100, duration: 1 })
  .to(".box3", { rotation: 360, duration: 1 });
```

### ä½¿ç”¨ stagger æ‰¹é‡åŠ¨ç”»

```javascript
// âœ… æ¨èï¼šä½¿ç”¨ stagger
gsap.to(".item", {
  x: 100,
  duration: 1,
  stagger: 0.1
});

// âŒ ä¸æ¨èï¼šå¾ªç¯åˆ›å»ºå¤šä¸ªåŠ¨ç”»
document.querySelectorAll(".item").forEach((item, i) => {
  gsap.to(item, {
    x: 100,
    duration: 1,
    delay: i * 0.1
  });
});
```

---

## ğŸ“Š æ€§èƒ½ç›‘æ§

### ä½¿ç”¨ DevTools ç›‘æ§

1. **Performance é¢æ¿**ï¼šå½•åˆ¶åŠ¨ç”»æ€§èƒ½
2. **Rendering é¢æ¿**ï¼šæ˜¾ç¤ºé‡æ’é‡ç»˜
3. **FPS è®¡æ•°å™¨**ï¼šç›‘æ§å¸§ç‡

### ä»£ç æ€§èƒ½ç›‘æ§

```javascript
// ç›‘æ§åŠ¨ç”»æ€§èƒ½
const startTime = performance.now();

gsap.to(".box", {
  x: 100,
  duration: 1,
  onComplete: function() {
    const endTime = performance.now();
    console.log(`åŠ¨ç”»è€—æ—¶: ${endTime - startTime}ms`);
  }
});
```

### ä½¿ç”¨ requestAnimationFrame

```javascript
let frameCount = 0;
let lastTime = performance.now();

function measureFPS() {
  frameCount++;
  const currentTime = performance.now();
  
  if (currentTime >= lastTime + 1000) {
    console.log(`FPS: ${frameCount}`);
    frameCount = 0;
    lastTime = currentTime;
  }
  
  requestAnimationFrame(measureFPS);
}

measureFPS();
```

---

## ğŸ¯ ScrollTrigger æ€§èƒ½ä¼˜åŒ–

### å‡å°‘ ScrollTrigger æ•°é‡

```javascript
// âŒ ä¸æ¨èï¼šä¸ºæ¯ä¸ªå…ƒç´ åˆ›å»º ScrollTrigger
elements.forEach(element => {
  gsap.from(element, {
    scrollTrigger: {
      trigger: element,
      start: "top 80%"
    }
  });
});

// âœ… æ¨èï¼šæ‰¹é‡å¤„ç†
gsap.utils.toArray(".item").forEach((item, i) => {
  gsap.from(item, {
    y: 50,
    opacity: 0,
    duration: 0.5,
    scrollTrigger: {
      trigger: item,
      start: "top 80%",
      toggleActions: "play none none reverse"
    },
    delay: i * 0.1
  });
});
```

### ä½¿ç”¨ markers è°ƒè¯•åç§»é™¤

```javascript
// å¼€å‘æ—¶ä½¿ç”¨
scrollTrigger: {
  trigger: ".box",
  start: "top center",
  markers: true  // è°ƒè¯•æ—¶ä½¿ç”¨
}

// ç”Ÿäº§ç¯å¢ƒç§»é™¤
scrollTrigger: {
  trigger: ".box",
  start: "top center",
  markers: false  // ç”Ÿäº§ç¯å¢ƒå…³é—­
}
```

### åŠæ—¶åˆ·æ–°å’Œæ¸…ç†

```javascript
// çª—å£å¤§å°æ”¹å˜æ—¶åˆ·æ–°
window.addEventListener("resize", () => {
  ScrollTrigger.refresh();
});

// ç»„ä»¶å¸è½½æ—¶æ¸…ç†
function cleanup() {
  ScrollTrigger.getAll().forEach(st => st.kill());
}
```

---

## ğŸ’¡ ä¼˜åŒ–æŠ€å·§

### 1. å‡å°‘åŒæ—¶è¿è¡Œçš„åŠ¨ç”»

```javascript
// âœ… æ¨èï¼šä½¿ç”¨ Timeline æ§åˆ¶åŠ¨ç”»æ•°é‡
const tl = gsap.timeline();
tl.to(".box1", { x: 100 })
  .to(".box2", { y: 100 })
  .to(".box3", { rotation: 360 });

// âŒ ä¸æ¨èï¼šåŒæ—¶è¿è¡Œå¤ªå¤šåŠ¨ç”»
for (let i = 0; i < 100; i++) {
  gsap.to(`.box${i}`, { x: 100 });
}
```

### 2. ä½¿ç”¨å¯¹è±¡å¼•ç”¨è€Œä¸æ˜¯é€‰æ‹©å™¨

```javascript
// âœ… æ¨èï¼šæ€§èƒ½æ›´å¥½
const box = document.querySelector(".box");
gsap.to(box, { x: 100 });

// âŒ ä¸æ¨èï¼šæ¯æ¬¡éƒ½è¦æŸ¥è¯¢ DOM
gsap.to(".box", { x: 100 });
```

### 3. åˆç†ä½¿ç”¨ ease

```javascript
// âœ… æ¨èï¼šç®€å•çš„ç¼“åŠ¨å‡½æ•°
gsap.to(".box", {
  x: 100,
  ease: "power2.out"  // æ€§èƒ½å¥½
});

// âš ï¸ è°¨æ…ä½¿ç”¨ï¼šå¤æ‚çš„è‡ªå®šä¹‰ç¼“åŠ¨
gsap.to(".box", {
  x: 100,
  ease: function(t) {
    // å¤æ‚çš„è®¡ç®—å¯èƒ½å½±å“æ€§èƒ½
    return Math.sin(t * Math.PI);
  }
});
```

### 4. é¿å…é¢‘ç¹æ›´æ–°

```javascript
// âŒ ä¸æ¨èï¼šé¢‘ç¹æ›´æ–°
gsap.to(".box", {
  x: 100,
  onUpdate: function() {
    // é¢‘ç¹æ‰§è¡Œå¯èƒ½å½±å“æ€§èƒ½
    console.log(this.progress());
  }
});

// âœ… æ¨èï¼šèŠ‚æµæ›´æ–°
let lastUpdate = 0;
gsap.to(".box", {
  x: 100,
  onUpdate: function() {
    const now = performance.now();
    if (now - lastUpdate > 100) {  // æ¯ 100ms æ›´æ–°ä¸€æ¬¡
      console.log(this.progress());
      lastUpdate = now;
    }
  }
});
```

---

## ğŸ”§ æ€§èƒ½æµ‹è¯•

### æ€§èƒ½åŸºå‡†æµ‹è¯•

```javascript
function performanceTest(iterations = 100) {
  const startTime = performance.now();
  
  for (let i = 0; i < iterations; i++) {
    gsap.to(".test-box", {
      x: Math.random() * 100,
      duration: 0.1
    });
  }
  
  const endTime = performance.now();
  const duration = endTime - startTime;
  const avgTime = duration / iterations;
  
  console.log(`æ€»è€—æ—¶: ${duration}ms`);
  console.log(`å¹³å‡è€—æ—¶: ${avgTime}ms`);
  console.log(`ç†è®º FPS: ${1000 / avgTime}`);
}
```

---

## ğŸ“ æ€§èƒ½æ£€æŸ¥æ¸…å•

### å¼€å‘æ—¶æ£€æŸ¥

- [ ] ä½¿ç”¨ transform å’Œ opacity
- [ ] é¿å…åŠ¨ç”» widthã€heightã€leftã€top
- [ ] ä½¿ç”¨ Timeline ç®¡ç†å¤šä¸ªåŠ¨ç”»
- [ ] ä½¿ç”¨ stagger æ‰¹é‡åŠ¨ç”»
- [ ] åˆç†ä½¿ç”¨ will-change
- [ ] åŠæ—¶æ¸…ç† ScrollTrigger
- [ ] çª—å£å¤§å°æ”¹å˜æ—¶åˆ·æ–° ScrollTrigger

### ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥

- [ ] ç§»é™¤ markers
- [ ] ç§»é™¤ console.log
- [ ] ä¼˜åŒ–åŠ¨ç”»æ•°é‡
- [ ] æµ‹è¯•ä¸åŒè®¾å¤‡æ€§èƒ½
- [ ] ç›‘æ§å®é™… FPS

---

## ğŸ”— ç›¸å…³èµ„æº

- [GSAP æ€§èƒ½ä¼˜åŒ–æŒ‡å—](https://greensock.com/docs/v3/GSAP/gsap.set())
- [æµè§ˆå™¨æ€§èƒ½ä¼˜åŒ– - MDN](https://developer.mozilla.org/en-US/docs/Web/Performance)
- [æ€§èƒ½ä¼˜åŒ– MOC](../../../../04-è´¨é‡ä¿éšœ/æ€§èƒ½/!MOC-æ€§èƒ½.md)
- [ä¸Šä¸€èŠ‚ï¼šGSAP å®æˆ˜æ¡ˆä¾‹](./08-GSAPå®æˆ˜æ¡ˆä¾‹.md)
- [ä¸‹ä¸€èŠ‚ï¼šReact é›†æˆ](./10-Reacté›†æˆ.md)

---

#GSAP #æ€§èƒ½ä¼˜åŒ– #60fps #åŠ¨ç”»æ€§èƒ½
