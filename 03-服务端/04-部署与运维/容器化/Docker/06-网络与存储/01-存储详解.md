# Docker å­˜å‚¨è¯¦è§£

> Docker å­˜å‚¨æ¶æ„ã€å­˜å‚¨é©±åŠ¨ç±»å‹å’Œæ•°æ®ç®¡ç†

---

## ğŸ“‹ ç›®å½•

- [å­˜å‚¨é©±åŠ¨ç±»å‹](#å­˜å‚¨é©±åŠ¨ç±»å‹)
- [æ•°æ®å·ï¼ˆVolumeï¼‰](#æ•°æ®å·volume)
- [ç»‘å®šæŒ‚è½½ï¼ˆBind Mountï¼‰](#ç»‘å®šæŒ‚è½½bind-mount)
- [tmpfs æŒ‚è½½](#tmpfs-æŒ‚è½½)
- [å­˜å‚¨é©±åŠ¨é€‰æ‹©](#å­˜å‚¨é©±åŠ¨é€‰æ‹©)
- [æ•°æ®å¤‡ä»½ä¸æ¢å¤](#æ•°æ®å¤‡ä»½ä¸æ¢å¤)

---

## å­˜å‚¨é©±åŠ¨ç±»å‹

### å¸¸è§å­˜å‚¨é©±åŠ¨

- **overlay2**ï¼šæ¨èä½¿ç”¨ï¼Œæ€§èƒ½å¥½
- **aufs**ï¼šæ—§ç‰ˆæœ¬ä½¿ç”¨
- **devicemapper**ï¼šCentOS/RHEL ä½¿ç”¨
- **btrfs**ï¼šBtrfs æ–‡ä»¶ç³»ç»Ÿ
- **zfs**ï¼šZFS æ–‡ä»¶ç³»ç»Ÿ

### æŸ¥çœ‹å­˜å‚¨é©±åŠ¨

```bash
# æŸ¥çœ‹å­˜å‚¨é©±åŠ¨
docker info | grep "Storage Driver"
```

---

## æ•°æ®å·ï¼ˆVolumeï¼‰

### åˆ›å»ºæ•°æ®å·

```bash
# åˆ›å»ºæ•°æ®å·
docker volume create my-volume

# åˆ›å»ºæ•°æ®å·å¹¶æŒ‡å®šé©±åŠ¨
docker volume create --driver local my-volume
```

### ä½¿ç”¨æ•°æ®å·

```bash
# ä½¿ç”¨æ•°æ®å·
docker run -d -v my-volume:/data nginx:latest

# ä½¿ç”¨åŒ¿åæ•°æ®å·
docker run -d -v /data nginx:latest
```

### ç®¡ç†æ•°æ®å·

```bash
# åˆ—å‡ºæ‰€æœ‰æ•°æ®å·
docker volume ls

# æŸ¥çœ‹æ•°æ®å·è¯¦ç»†ä¿¡æ¯
docker volume inspect my-volume

# åˆ é™¤æ•°æ®å·
docker volume rm my-volume

# åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„æ•°æ®å·
docker volume prune
```

---

## ç»‘å®šæŒ‚è½½ï¼ˆBind Mountï¼‰

### ä½¿ç”¨ç»‘å®šæŒ‚è½½

```bash
# ç»‘å®šæŒ‚è½½ç›®å½•
docker run -d -v /host/path:/container/path nginx:latest

# åªè¯»æŒ‚è½½
docker run -d -v /host/path:/container/path:ro nginx:latest
```

### æŒ‚è½½é€‰é¡¹

- `rw`ï¼šè¯»å†™ï¼ˆé»˜è®¤ï¼‰
- `ro`ï¼šåªè¯»
- `z`ï¼šå…±äº« SELinux æ ‡ç­¾
- `Z`ï¼šç§æœ‰ SELinux æ ‡ç­¾

---

## tmpfs æŒ‚è½½

### ä½¿ç”¨ tmpfs

```bash
# ä½¿ç”¨ tmpfs
docker run -d --tmpfs /tmp nginx:latest

# æŒ‡å®š tmpfs å¤§å°
docker run -d --tmpfs /tmp:rw,noexec,nosuid,size=100m nginx:latest
```

---

## å­˜å‚¨é©±åŠ¨é€‰æ‹©

### é€‰æ‹©å»ºè®®

- **overlay2**ï¼šæ¨èä½¿ç”¨
- **aufs**ï¼šæ—§ç³»ç»Ÿä½¿ç”¨
- **devicemapper**ï¼šCentOS/RHEL

### é…ç½®å­˜å‚¨é©±åŠ¨

```json
// /etc/docker/daemon.json
{
  "storage-driver": "overlay2"
}
```

---

## æ•°æ®å¤‡ä»½ä¸æ¢å¤

### å¤‡ä»½æ•°æ®å·

```bash
# å¤‡ä»½æ•°æ®å·
docker run --rm \
  -v my-volume:/data \
  -v $(pwd):/backup \
  ubuntu:20.04 \
  tar czf /backup/backup.tar.gz /data
```

### æ¢å¤æ•°æ®å·

```bash
# æ¢å¤æ•°æ®å·
docker run --rm \
  -v my-volume:/data \
  -v $(pwd):/backup \
  ubuntu:20.04 \
  tar xzf /backup/backup.tar.gz -C /
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [Docker å®˜æ–¹æ–‡æ¡£ - å­˜å‚¨](https://docs.docker.com/storage/)
- [Docker å®˜æ–¹æ–‡æ¡£ - å­˜å‚¨é©±åŠ¨](https://docs.docker.com/storage/storagedriver/)

---

[[!MOC-Docker|è¿”å› Docker çŸ¥è¯†ä½“ç³»]]

#Docker #å­˜å‚¨ #æ•°æ®å·
