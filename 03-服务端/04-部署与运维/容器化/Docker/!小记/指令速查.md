## Docker å¸¸ç”¨æŒ‡ä»¤é€ŸæŸ¥

> ä»¥ä¸‹æ˜¯ Docker æ—¥å¸¸å¼€å‘ & è¿ç»´ä¸­ç”¨å¾—æœ€å¤šçš„æ ¸å¿ƒæŒ‡ä»¤æ¸…å•ï¼ˆå«è§£é‡Šï¼‰ã€‚å…·ä½“é€‰é¡¹è¯¦è§å®˜æ–¹æ–‡æ¡£ã€‚

---

## ğŸ“¦ é•œåƒï¼ˆImageï¼‰æ“ä½œ

### æŸ¥çœ‹é•œåƒ
```bash
# åˆ—å‡ºæœ¬åœ°æ‰€æœ‰é•œåƒ
docker images
docker image ls

# æŸ¥çœ‹é•œåƒè¯¦ç»†ä¿¡æ¯
docker inspect <é•œåƒå:æ ‡ç­¾>
```

### æ‹‰å–é•œåƒ
```bash
# ä»ä»“åº“æ‹‰å–é•œåƒï¼ˆé»˜è®¤ latest æ ‡ç­¾ï¼‰
docker pull nginx

# æ‹‰å–æŒ‡å®šæ ‡ç­¾
docker pull nginx:1.21
docker pull nginx:alpine
```

### æ„å»ºé•œåƒ
```bash
# ä»å½“å‰ç›®å½•çš„ Dockerfile æ„å»ºé•œåƒ
docker build -t myapp:latest .

# æŒ‡å®š Dockerfile è·¯å¾„
docker build -f Dockerfile.prod -t myapp:prod .

# æ„å»ºæ—¶ä¸ä½¿ç”¨ç¼“å­˜
docker build --no-cache -t myapp:latest .
```

### åˆ é™¤é•œåƒ
```bash
# åˆ é™¤æŒ‡å®šé•œåƒ
docker rmi nginx:latest
docker image rm nginx:latest

# åˆ é™¤æœªä½¿ç”¨çš„é•œåƒï¼ˆæ¸…ç†ï¼‰
docker image prune

# å¼ºåˆ¶åˆ é™¤ï¼ˆå³ä½¿æœ‰å®¹å™¨åœ¨ä½¿ç”¨ï¼‰
docker rmi -f nginx:latest
```

### é•œåƒæ ‡ç­¾
```bash
# ç»™é•œåƒæ‰“æ ‡ç­¾
docker tag nginx:latest myregistry/nginx:v1.0
```

### å¯¼å‡º/å¯¼å…¥é•œåƒ
```bash
# å¯¼å‡ºé•œåƒä¸º tar æ–‡ä»¶
docker save -o nginx.tar nginx:latest

# ä» tar æ–‡ä»¶å¯¼å…¥é•œåƒ
docker load -i nginx.tar
```

---

## ğŸš€ å®¹å™¨ï¼ˆContainerï¼‰æ“ä½œ

### è¿è¡Œå®¹å™¨
```bash
# è¿è¡Œå®¹å™¨ï¼ˆå‰å°ï¼‰
docker run nginx:latest

# åå°è¿è¡Œï¼ˆ-dï¼‰
docker run -d nginx:latest

# æŒ‡å®šå®¹å™¨åç§°ï¼ˆ--nameï¼‰
docker run -d --name my-nginx nginx:latest

# ç«¯å£æ˜ å°„ï¼ˆ-p ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ï¼‰
docker run -d -p 8080:80 nginx:latest

# æŒ‚è½½æ•°æ®å·ï¼ˆ-vï¼‰
docker run -d -v /host/path:/container/path nginx:latest

# è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆ-eï¼‰
docker run -d -e MYSQL_ROOT_PASSWORD=123456 mysql:latest

# äº¤äº’å¼è¿è¡Œï¼ˆ-itï¼‰
docker run -it ubuntu:latest /bin/bash

# è‡ªåŠ¨åˆ é™¤å®¹å™¨ï¼ˆ--rmï¼Œåœæ­¢åè‡ªåŠ¨åˆ é™¤ï¼‰
docker run --rm nginx:latest
```

### æŸ¥çœ‹å®¹å™¨
```bash
# æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨
docker ps

# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬åœæ­¢çš„ï¼‰
docker ps -a

# æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯
docker inspect <å®¹å™¨å/ID>

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs <å®¹å™¨å/ID>

# å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼ˆ-fï¼‰
docker logs -f <å®¹å™¨å/ID>

# æŸ¥çœ‹æœ€è¿‘ N æ¡æ—¥å¿—
docker logs --tail 100 <å®¹å™¨å/ID>
```

### å®¹å™¨å¯åœ
```bash
# å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨
docker start <å®¹å™¨å/ID>

# åœæ­¢è¿è¡Œä¸­çš„å®¹å™¨
docker stop <å®¹å™¨å/ID>

# é‡å¯å®¹å™¨
docker restart <å®¹å™¨å/ID>

# å¼ºåˆ¶åœæ­¢ï¼ˆkillï¼‰
docker kill <å®¹å™¨å/ID>

# æš‚åœå®¹å™¨ï¼ˆæš‚åœè¿›ç¨‹ï¼‰
docker pause <å®¹å™¨å/ID>

# æ¢å¤æš‚åœçš„å®¹å™¨
docker unpause <å®¹å™¨å/ID>
```

### è¿›å…¥å®¹å™¨
```bash
# è¿›å…¥è¿è¡Œä¸­çš„å®¹å™¨ï¼ˆæ¨èï¼‰
docker exec -it <å®¹å™¨å/ID> /bin/bash
docker exec -it <å®¹å™¨å/ID> /bin/sh

# åœ¨å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤
docker exec <å®¹å™¨å/ID> ls /app
```

### åˆ é™¤å®¹å™¨
```bash
# åˆ é™¤å·²åœæ­¢çš„å®¹å™¨
docker rm <å®¹å™¨å/ID>

# å¼ºåˆ¶åˆ é™¤è¿è¡Œä¸­çš„å®¹å™¨ï¼ˆ-fï¼‰
docker rm -f <å®¹å™¨å/ID>

# åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨
docker container prune

# åˆ é™¤æ‰€æœ‰å®¹å™¨ï¼ˆå±é™©æ“ä½œï¼‰
docker rm -f $(docker ps -aq)
```

### å®¹å™¨ä¸ä¸»æœºæ–‡ä»¶å¤åˆ¶
```bash
# ä»å®¹å™¨å¤åˆ¶æ–‡ä»¶åˆ°ä¸»æœº
docker cp <å®¹å™¨å/ID>:/path/to/file /host/path

# ä»ä¸»æœºå¤åˆ¶æ–‡ä»¶åˆ°å®¹å™¨
docker cp /host/path <å®¹å™¨å/ID>:/path/to/file
```

---

## ğŸŒ ç½‘ç»œï¼ˆNetworkï¼‰æ“ä½œ

### æŸ¥çœ‹ç½‘ç»œ
```bash
# åˆ—å‡ºæ‰€æœ‰ç½‘ç»œ
docker network ls

# æŸ¥çœ‹ç½‘ç»œè¯¦ç»†ä¿¡æ¯
docker network inspect bridge
```

### åˆ›å»ºç½‘ç»œ
```bash
# åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œ
docker network create mynetwork

# åˆ›å»ºæ¡¥æ¥ç½‘ç»œ
docker network create --driver bridge mybridge
```

### è¿æ¥å®¹å™¨åˆ°ç½‘ç»œ
```bash
# è¿è¡Œå®¹å™¨æ—¶è¿æ¥åˆ°ç½‘ç»œ
docker run -d --network mynetwork nginx:latest

# å°†è¿è¡Œä¸­çš„å®¹å™¨è¿æ¥åˆ°ç½‘ç»œ
docker network connect mynetwork <å®¹å™¨å/ID>

# æ–­å¼€å®¹å™¨ä¸ç½‘ç»œçš„è¿æ¥
docker network disconnect mynetwork <å®¹å™¨å/ID>
```

### åˆ é™¤ç½‘ç»œ
```bash
# åˆ é™¤ç½‘ç»œ
docker network rm mynetwork

# åˆ é™¤æœªä½¿ç”¨çš„ç½‘ç»œ
docker network prune
```

---

## ğŸ’¾ æ•°æ®å·ï¼ˆVolumeï¼‰æ“ä½œ

### æŸ¥çœ‹æ•°æ®å·
```bash
# åˆ—å‡ºæ‰€æœ‰æ•°æ®å·
docker volume ls

# æŸ¥çœ‹æ•°æ®å·è¯¦ç»†ä¿¡æ¯
docker volume inspect <å·å>
```

### åˆ›å»ºæ•°æ®å·
```bash
# åˆ›å»ºæ•°æ®å·
docker volume create myvolume
```

### ä½¿ç”¨æ•°æ®å·
```bash
# è¿è¡Œå®¹å™¨æ—¶æŒ‚è½½æ•°æ®å·
docker run -d -v myvolume:/data nginx:latest

# æŒ‚è½½ä¸»æœºç›®å½•ï¼ˆbind mountï¼‰
docker run -d -v /host/path:/container/path nginx:latest

# åªè¯»æŒ‚è½½
docker run -d -v myvolume:/data:ro nginx:latest
```

### åˆ é™¤æ•°æ®å·
```bash
# åˆ é™¤æ•°æ®å·
docker volume rm <å·å>

# åˆ é™¤æœªä½¿ç”¨çš„æ•°æ®å·ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
docker volume prune
```

---

## ğŸ³ Docker Compose æ“ä½œ

### å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆåå°ï¼‰
docker-compose up -d

# å¯åŠ¨å¹¶æ„å»ºé•œåƒ
docker-compose up -d --build

# å¯åŠ¨æŒ‡å®šæœåŠ¡
docker-compose up -d nginx
```

### æŸ¥çœ‹æœåŠ¡
```bash
# æŸ¥çœ‹è¿è¡Œä¸­çš„æœåŠ¡
docker-compose ps

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs

# å®æ—¶æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹æŒ‡å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f nginx
```

### åœæ­¢æœåŠ¡
```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose stop

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨
docker-compose down

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨ã€ç½‘ç»œã€æ•°æ®å·
docker-compose down -v
```

### å…¶ä»–æ“ä½œ
```bash
# é‡å¯æœåŠ¡
docker-compose restart

# æ‰§è¡Œå‘½ä»¤
docker-compose exec nginx /bin/bash

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
```

---

## ğŸ” ç³»ç»Ÿä¿¡æ¯ä¸ç»´æŠ¤

### ç³»ç»Ÿä¿¡æ¯
```bash
# æŸ¥çœ‹ Docker ç‰ˆæœ¬
docker version

# æŸ¥çœ‹ Docker ç³»ç»Ÿä¿¡æ¯
docker info

# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µ
docker system df
```

### æ¸…ç†æ“ä½œ
```bash
# æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨çš„èµ„æºï¼ˆé•œåƒã€å®¹å™¨ã€ç½‘ç»œã€æ•°æ®å·ï¼‰
docker system prune

# æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨çš„èµ„æºï¼ˆåŒ…æ‹¬æœªä½¿ç”¨çš„é•œåƒï¼‰
docker system prune -a

# æ¸…ç†æ‰€æœ‰æœªä½¿ç”¨çš„èµ„æºï¼ˆåŒ…æ‹¬æ•°æ®å·ï¼‰
docker system prune -a --volumes
```

### èµ„æºç›‘æ§
```bash
# æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ
docker stats

# æŸ¥çœ‹æŒ‡å®šå®¹å™¨èµ„æºä½¿ç”¨
docker stats <å®¹å™¨å/ID>

# å®æ—¶ç›‘æ§ï¼ˆé»˜è®¤å·²å¼€å¯ï¼‰
docker stats --no-stream
```

---

## ğŸ”§ å®ç”¨æŠ€å·§

### æ‰¹é‡æ“ä½œ
```bash
# åœæ­¢æ‰€æœ‰è¿è¡Œä¸­çš„å®¹å™¨
docker stop $(docker ps -q)

# åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨
docker rm $(docker ps -aq)

# åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„é•œåƒ
docker image prune -a
```

### æŸ¥çœ‹å®¹å™¨è¿›ç¨‹
```bash
# æŸ¥çœ‹å®¹å™¨å†…è¿›ç¨‹
docker top <å®¹å™¨å/ID>
```

### æŸ¥çœ‹å®¹å™¨ç«¯å£æ˜ å°„
```bash
# æŸ¥çœ‹å®¹å™¨ç«¯å£æ˜ å°„
docker port <å®¹å™¨å/ID>
```

### å¯¼å‡º/å¯¼å…¥å®¹å™¨
```bash
# å¯¼å‡ºå®¹å™¨ä¸º tar æ–‡ä»¶
docker export -o container.tar <å®¹å™¨å/ID>

# ä» tar æ–‡ä»¶å¯¼å…¥ä¸ºé•œåƒ
docker import container.tar myimage:latest
```

---

## ğŸ“ å¸¸ç”¨å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ |
|------|------|
| `-d` | åå°è¿è¡Œï¼ˆdetached modeï¼‰ |
| `-it` | äº¤äº’å¼ç»ˆç«¯ï¼ˆinteractive + TTYï¼‰ |
| `-p` | ç«¯å£æ˜ å°„ï¼ˆhost:containerï¼‰ |
| `-v` | æ•°æ®å·æŒ‚è½½ï¼ˆvolumeï¼‰ |
| `-e` | ç¯å¢ƒå˜é‡ï¼ˆenvironmentï¼‰ |
| `--name` | æŒ‡å®šå®¹å™¨åç§° |
| `--rm` | å®¹å™¨åœæ­¢åè‡ªåŠ¨åˆ é™¤ |
| `-f` | å¼ºåˆ¶æ“ä½œï¼ˆforceï¼‰ |
| `-a` | æ‰€æœ‰ï¼ˆallï¼‰ |
| `-q` | åªæ˜¾ç¤º IDï¼ˆquietï¼‰ |

---

## ğŸ¯ å¸¸ç”¨åœºæ™¯å‘½ä»¤ç»„åˆ

### åœºæ™¯ 1ï¼šå¿«é€Ÿå¯åŠ¨ä¸€ä¸ª Web æœåŠ¡
```bash
docker run -d --name my-nginx -p 8080:80 nginx:latest
```

### åœºæ™¯ 2ï¼šå¼€å‘ç¯å¢ƒæŒ‚è½½ä»£ç ç›®å½•
```bash
docker run -d --name dev-app \
  -p 3000:3000 \
  -v $(pwd):/app \
  node:16-alpine
```

### åœºæ™¯ 3ï¼šæŸ¥çœ‹å®¹å™¨æ—¥å¿—å¹¶è¿‡æ»¤
```bash
docker logs -f <å®¹å™¨å> | grep ERROR
```

### åœºæ™¯ 4ï¼šè¿›å…¥å®¹å™¨è°ƒè¯•
```bash
docker exec -it <å®¹å™¨å> /bin/bash
```

### åœºæ™¯ 5ï¼šæ¸…ç†æ‰€æœ‰èµ„æº
```bash
docker system prune -a --volumes
```

---

> ğŸ’¡ **æç¤º**ï¼šæ›´å¤šè¯¦ç»†é€‰é¡¹è¯·ä½¿ç”¨ `docker <command> --help` æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ã€‚
