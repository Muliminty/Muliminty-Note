# å®¹å™¨ç½‘ç»œåŸºç¡€

> Docker å®¹å™¨çš„ç½‘ç»œé…ç½®ã€ç«¯å£æ˜ å°„ã€å®¹å™¨é—´é€šä¿¡

---

## ğŸ“‹ ç›®å½•

- [ç½‘ç»œæ¨¡å¼](#ç½‘ç»œæ¨¡å¼)
- [ç«¯å£æ˜ å°„](#ç«¯å£æ˜ å°„)
- [å®¹å™¨é—´é€šä¿¡](#å®¹å™¨é—´é€šä¿¡)
- [è‡ªå®šä¹‰ç½‘ç»œ](#è‡ªå®šä¹‰ç½‘ç»œ)
- [ç½‘ç»œéš”ç¦»](#ç½‘ç»œéš”ç¦»)
- [DNS é…ç½®](#dns-é…ç½®)

---

## ç½‘ç»œæ¨¡å¼

### Bridge æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰

æ¯ä¸ªå®¹å™¨éƒ½æœ‰ç‹¬ç«‹çš„ç½‘ç»œå‘½åç©ºé—´ï¼Œé€šè¿‡ Docker ç½‘æ¡¥è¿æ¥ã€‚

```bash
# ä½¿ç”¨é»˜è®¤ bridge ç½‘ç»œ
docker run -d --network bridge nginx:latest
```

### Host æ¨¡å¼

å®¹å™¨ç›´æ¥ä½¿ç”¨å®¿ä¸»æœºçš„ç½‘ç»œã€‚

```bash
# ä½¿ç”¨ host ç½‘ç»œ
docker run -d --network host nginx:latest
```

### None æ¨¡å¼

å®¹å™¨æ²¡æœ‰ç½‘ç»œæ¥å£ã€‚

```bash
# ä½¿ç”¨ none ç½‘ç»œ
docker run -d --network none nginx:latest
```

### Container æ¨¡å¼

å®¹å™¨å…±äº«å¦ä¸€ä¸ªå®¹å™¨çš„ç½‘ç»œå‘½åç©ºé—´ã€‚

```bash
# å…±äº«å®¹å™¨çš„ç½‘ç»œ
docker run -d --network container:other-container nginx:latest
```

---

## ç«¯å£æ˜ å°„

### -p / --publish

æ˜ å°„å®¹å™¨ç«¯å£åˆ°å®¿ä¸»æœºç«¯å£ã€‚

```bash
# æ˜ å°„ç«¯å£ï¼ˆè‡ªåŠ¨ç»‘å®šæ‰€æœ‰æ¥å£ï¼‰
docker run -d -p 8080:80 nginx:latest

# æ˜ å°„ç«¯å£ï¼ˆæŒ‡å®š IPï¼‰
docker run -d -p 127.0.0.1:8080:80 nginx:latest

# æ˜ å°„ç«¯å£ï¼ˆè‡ªåŠ¨åˆ†é…å®¿ä¸»æœºç«¯å£ï¼‰
docker run -d -p 80 nginx:latest

# æ˜ å°„å¤šä¸ªç«¯å£
docker run -d -p 8080:80 -p 8443:443 nginx:latest

# æ˜ å°„ UDP ç«¯å£
docker run -d -p 53:53/udp dns-server:latest
```

### -P / --publish-all

è‡ªåŠ¨æ˜ å°„æ‰€æœ‰ EXPOSE çš„ç«¯å£ã€‚

```bash
# è‡ªåŠ¨æ˜ å°„æ‰€æœ‰ç«¯å£
docker run -d -P nginx:latest
```

---

## å®¹å™¨é—´é€šä¿¡

### é»˜è®¤ Bridge ç½‘ç»œ

åŒä¸€ bridge ç½‘ç»œä¸­çš„å®¹å™¨å¯ä»¥é€šè¿‡å®¹å™¨åæˆ– IP é€šä¿¡ã€‚

```bash
# åˆ›å»ºä¸¤ä¸ªå®¹å™¨
docker run -d --name web nginx:latest
docker run -d --name app myapp:latest

# åœ¨ app å®¹å™¨ä¸­è®¿é—® web å®¹å™¨
docker exec app curl http://web
```

### è‡ªå®šä¹‰ç½‘ç»œ

ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œå¯ä»¥æ›´å¥½åœ°ç®¡ç†å®¹å™¨é€šä¿¡ã€‚

```bash
# åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œ
docker network create my-network

# å°†å®¹å™¨è¿æ¥åˆ°ç½‘ç»œ
docker run -d --name web --network my-network nginx:latest
docker run -d --name app --network my-network myapp:latest

# å®¹å™¨å¯ä»¥é€šè¿‡åç§°é€šä¿¡
docker exec app curl http://web
```

---

## è‡ªå®šä¹‰ç½‘ç»œ

### åˆ›å»ºç½‘ç»œ

```bash
# åˆ›å»º bridge ç½‘ç»œ
docker network create my-network

# åˆ›å»ºç½‘ç»œå¹¶æŒ‡å®šå­ç½‘
docker network create --subnet=172.20.0.0/16 my-network

# åˆ›å»ºç½‘ç»œå¹¶æŒ‡å®šç½‘å…³
docker network create \
  --subnet=172.20.0.0/16 \
  --gateway=172.20.0.1 \
  my-network
```

### ç®¡ç†ç½‘ç»œ

```bash
# åˆ—å‡ºæ‰€æœ‰ç½‘ç»œ
docker network ls

# æŸ¥çœ‹ç½‘ç»œè¯¦ç»†ä¿¡æ¯
docker network inspect my-network

# åˆ é™¤ç½‘ç»œ
docker network rm my-network

# åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„ç½‘ç»œ
docker network prune
```

### è¿æ¥å®¹å™¨åˆ°ç½‘ç»œ

```bash
# è¿è¡Œå®¹å™¨æ—¶è¿æ¥åˆ°ç½‘ç»œ
docker run -d --network my-network nginx:latest

# å°†è¿è¡Œä¸­çš„å®¹å™¨è¿æ¥åˆ°ç½‘ç»œ
docker network connect my-network my-container

# æ–­å¼€å®¹å™¨ä¸ç½‘ç»œçš„è¿æ¥
docker network disconnect my-network my-container
```

---

## ç½‘ç»œéš”ç¦»

### ç½‘ç»œéš”ç¦»åŸç†

ä¸åŒç½‘ç»œä¸­çš„å®¹å™¨é»˜è®¤æ— æ³•é€šä¿¡ï¼Œå®ç°ç½‘ç»œéš”ç¦»ã€‚

```bash
# åˆ›å»ºä¸¤ä¸ªç½‘ç»œ
docker network create network1
docker network create network2

# åœ¨ä¸åŒç½‘ç»œä¸­åˆ›å»ºå®¹å™¨
docker run -d --name app1 --network network1 myapp:latest
docker run -d --name app2 --network network2 myapp:latest

# app1 å’Œ app2 æ— æ³•ç›´æ¥é€šä¿¡
```

### å¤šç½‘ç»œè¿æ¥

å®¹å™¨å¯ä»¥è¿æ¥åˆ°å¤šä¸ªç½‘ç»œã€‚

```bash
# åˆ›å»ºä¸¤ä¸ªç½‘ç»œ
docker network create frontend
docker network create backend

# å®¹å™¨è¿æ¥åˆ°å¤šä¸ªç½‘ç»œ
docker run -d --name web --network frontend nginx:latest
docker network connect backend web
```

---

## DNS é…ç½®

### å®¹å™¨ DNS

å®¹å™¨ä½¿ç”¨ Docker çš„ DNS æœåŠ¡å™¨è§£æå®¹å™¨åã€‚

```bash
# æŸ¥çœ‹å®¹å™¨ DNS é…ç½®
docker inspect -f '{{.NetworkSettings.DNS}}' my-container
```

### è‡ªå®šä¹‰ DNS

```bash
# ä½¿ç”¨è‡ªå®šä¹‰ DNS æœåŠ¡å™¨
docker run -d --dns 8.8.8.8 nginx:latest

# ä½¿ç”¨å¤šä¸ª DNS æœåŠ¡å™¨
docker run -d --dns 8.8.8.8 --dns 8.8.4.4 nginx:latest

# æ·»åŠ  DNS æœç´¢åŸŸ
docker run -d --dns-search example.com nginx:latest
```

### /etc/hosts

```bash
# æ·»åŠ ä¸»æœºåæ˜ å°„
docker run -d --add-host hostname:192.168.1.100 nginx:latest
```

---

## å®ç”¨ç¤ºä¾‹

### Web åº”ç”¨ + æ•°æ®åº“

```bash
# åˆ›å»ºç½‘ç»œ
docker network create app-network

# å¯åŠ¨æ•°æ®åº“
docker run -d \
  --name db \
  --network app-network \
  -e POSTGRES_PASSWORD=password \
  postgres:13

# å¯åŠ¨ Web åº”ç”¨
docker run -d \
  --name web \
  --network app-network \
  -p 8080:80 \
  -e DATABASE_URL=postgres://db:5432/mydb \
  myapp:latest
```

### å¾®æœåŠ¡æ¶æ„

```bash
# åˆ›å»ºç½‘ç»œ
docker network create microservices

# å¯åŠ¨å„ä¸ªæœåŠ¡
docker run -d --name api --network microservices api:latest
docker run -d --name auth --network microservices auth:latest
docker run -d --name gateway --network microservices -p 80:80 gateway:latest
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [Docker å®˜æ–¹æ–‡æ¡£ - ç½‘ç»œ](https://docs.docker.com/network/)
- [Docker å®˜æ–¹æ–‡æ¡£ - ç½‘ç»œé©±åŠ¨](https://docs.docker.com/network/drivers/)

---

[[!MOC-Docker|è¿”å› Docker çŸ¥è¯†ä½“ç³»]]

#Docker #å®¹å™¨ #ç½‘ç»œ
