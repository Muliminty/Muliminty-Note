# å®¹å™¨åŸºç¡€æ“ä½œ

> Docker å®¹å™¨çš„åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ç­‰åŸºç¡€æ“ä½œ

---

## ğŸ“‹ ç›®å½•

- [åˆ›å»ºå®¹å™¨](#åˆ›å»ºå®¹å™¨)
- [å¯åŠ¨ä¸åœæ­¢å®¹å™¨](#å¯åŠ¨ä¸åœæ­¢å®¹å™¨)
- [é‡å¯å®¹å™¨](#é‡å¯å®¹å™¨)
- [åˆ é™¤å®¹å™¨](#åˆ é™¤å®¹å™¨)
- [æŸ¥çœ‹å®¹å™¨çŠ¶æ€](#æŸ¥çœ‹å®¹å™¨çŠ¶æ€)
- [è¿›å…¥å®¹å™¨å†…éƒ¨](#è¿›å…¥å®¹å™¨å†…éƒ¨)
- [å®¹å™¨ç”Ÿå‘½å‘¨æœŸ](#å®¹å™¨ç”Ÿå‘½å‘¨æœŸ)

---

## åˆ›å»ºå®¹å™¨

### docker create

åˆ›å»ºå®¹å™¨ä½†ä¸å¯åŠ¨ã€‚

```bash
# åˆ›å»ºå®¹å™¨
docker create --name my-container nginx:latest

# åˆ›å»ºå®¹å™¨å¹¶è®¾ç½®ç¯å¢ƒå˜é‡
docker create --name my-container \
  -e ENV_VAR=value \
  nginx:latest

# åˆ›å»ºå®¹å™¨å¹¶æ˜ å°„ç«¯å£
docker create --name my-container \
  -p 8080:80 \
  nginx:latest
```

### docker run

åˆ›å»ºå¹¶è¿è¡Œå®¹å™¨ã€‚

```bash
# è¿è¡Œå®¹å™¨ï¼ˆå‰å°ï¼‰
docker run nginx:latest

# è¿è¡Œå®¹å™¨ï¼ˆåå°ï¼‰
docker run -d nginx:latest

# è¿è¡Œå®¹å™¨ï¼ˆæŒ‡å®šåç§°ï¼‰
docker run -d --name my-nginx nginx:latest

# è¿è¡Œå®¹å™¨ï¼ˆäº¤äº’å¼ï¼‰
docker run -it ubuntu:20.04 /bin/bash

# è¿è¡Œå®¹å™¨ï¼ˆç«¯å£æ˜ å°„ï¼‰
docker run -d -p 8080:80 nginx:latest

# è¿è¡Œå®¹å™¨ï¼ˆè‡ªåŠ¨åˆ é™¤ï¼‰
docker run --rm ubuntu:20.04 echo "Hello"
```

---

## å¯åŠ¨ä¸åœæ­¢å®¹å™¨

### docker start

å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨ã€‚

```bash
# å¯åŠ¨å®¹å™¨
docker start my-container

# å¯åŠ¨å®¹å™¨å¹¶é™„åŠ åˆ°è¾“å‡º
docker start -a my-container

# å¯åŠ¨å¤šä¸ªå®¹å™¨
docker start container1 container2

# å¯åŠ¨æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨
docker start $(docker ps -a -q)
```

### docker stop

åœæ­¢è¿è¡Œä¸­çš„å®¹å™¨ã€‚

```bash
# åœæ­¢å®¹å™¨
docker stop my-container

# åœæ­¢å®¹å™¨ï¼ˆç«‹å³åœæ­¢ï¼‰
docker stop -t 0 my-container

# åœæ­¢å¤šä¸ªå®¹å™¨
docker stop container1 container2

# åœæ­¢æ‰€æœ‰è¿è¡Œä¸­çš„å®¹å™¨
docker stop $(docker ps -q)
```

### docker kill

å¼ºåˆ¶åœæ­¢å®¹å™¨ã€‚

```bash
# å¼ºåˆ¶åœæ­¢å®¹å™¨
docker kill my-container

# å‘é€ç‰¹å®šä¿¡å·
docker kill -s SIGTERM my-container
```

---

## é‡å¯å®¹å™¨

### docker restart

é‡å¯å®¹å™¨ã€‚

```bash
# é‡å¯å®¹å™¨
docker restart my-container

# é‡å¯å¤šä¸ªå®¹å™¨
docker restart container1 container2

# é‡å¯æ‰€æœ‰å®¹å™¨
docker restart $(docker ps -q)
```

---

## åˆ é™¤å®¹å™¨

### docker rm / docker container rm

åˆ é™¤å®¹å™¨ã€‚

```bash
# åˆ é™¤å·²åœæ­¢çš„å®¹å™¨
docker rm my-container

# å¼ºåˆ¶åˆ é™¤è¿è¡Œä¸­çš„å®¹å™¨
docker rm -f my-container

# åˆ é™¤å¤šä¸ªå®¹å™¨
docker rm container1 container2

# åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨
docker container prune

# åˆ é™¤æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬è¿è¡Œä¸­çš„ï¼‰
docker rm -f $(docker ps -aq)
```

### æ‰¹é‡åˆ é™¤

```bash
# åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨
docker container prune -f

# åˆ é™¤æŒ‡å®šçŠ¶æ€çš„å®¹å™¨
docker rm $(docker ps -a -f "status=exited" -q)
```

---

## æŸ¥çœ‹å®¹å™¨çŠ¶æ€

### docker ps / docker container ls

åˆ—å‡ºå®¹å™¨ã€‚

```bash
# åˆ—å‡ºè¿è¡Œä¸­çš„å®¹å™¨
docker ps

# åˆ—å‡ºæ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬å·²åœæ­¢çš„ï¼‰
docker ps -a

# åªæ˜¾ç¤ºå®¹å™¨ ID
docker ps -q

# æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨
docker ps -l

# æŒ‰æ ¼å¼è¾“å‡º
docker ps --format "table {{.ID}}\t{{.Names}}\t{{.Status}}"

# è¿‡æ»¤å®¹å™¨
docker ps -f "name=nginx"
docker ps -f "status=running"
docker ps -f "ancestor=nginx:latest"
```

### docker inspect

æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯ã€‚

```bash
# æŸ¥çœ‹å®¹å™¨ä¿¡æ¯
docker inspect my-container

# æŸ¥çœ‹ç‰¹å®šä¿¡æ¯
docker inspect -f '{{.NetworkSettings.IPAddress}}' my-container
docker inspect -f '{{.Config.Env}}' my-container
docker inspect -f '{{.State.Status}}' my-container
docker inspect -f '{{.Mounts}}' my-container
```

### docker stats

å®æ—¶æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µã€‚

```bash
# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çš„èµ„æºä½¿ç”¨
docker stats

# æŸ¥çœ‹æŒ‡å®šå®¹å™¨
docker stats my-container

# åªæ˜¾ç¤ºä¸€æ¬¡ï¼ˆä¸æŒç»­æ›´æ–°ï¼‰
docker stats --no-stream

# æŒ‰æ ¼å¼è¾“å‡º
docker stats --format "table {{.Container}}\t{{.CPUPerc}}\t{{.MemUsage}}"
```

---

## è¿›å…¥å®¹å™¨å†…éƒ¨

### docker exec

åœ¨è¿è¡Œä¸­çš„å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤ã€‚

```bash
# æ‰§è¡Œå‘½ä»¤
docker exec my-container ls /app

# äº¤äº’å¼æ‰§è¡Œï¼ˆè¿›å…¥å®¹å™¨ï¼‰
docker exec -it my-container /bin/bash

# ä»¥ root ç”¨æˆ·æ‰§è¡Œ
docker exec -u root my-container command

# åœ¨åå°æ‰§è¡Œ
docker exec -d my-container command
```

### docker attach

é™„åŠ åˆ°å®¹å™¨çš„æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯æµã€‚

```bash
# é™„åŠ åˆ°å®¹å™¨
docker attach my-container

# é€€å‡ºè€Œä¸åœæ­¢å®¹å™¨
# ä½¿ç”¨ Ctrl+P, Ctrl+Q
```

**æ³¨æ„**ï¼š`docker attach` ä¼šé™„åŠ åˆ°ä¸»è¿›ç¨‹ï¼Œå¦‚æœä¸»è¿›ç¨‹é€€å‡ºï¼Œå®¹å™¨ä¹Ÿä¼šåœæ­¢ã€‚å»ºè®®ä½¿ç”¨ `docker exec`ã€‚

---

## å®¹å™¨ç”Ÿå‘½å‘¨æœŸ

### çŠ¶æ€è½¬æ¢

```
åˆ›å»º (Created) â†’ è¿è¡Œ (Running) â†’ åœæ­¢ (Stopped) â†’ åˆ é™¤ (Removed)
                â†“
            æš‚åœ (Paused) â†’ æ¢å¤ (Running)
```

### å®¹å™¨çŠ¶æ€

- **Created**ï¼šå®¹å™¨å·²åˆ›å»ºä½†æœªå¯åŠ¨
- **Running**ï¼šå®¹å™¨æ­£åœ¨è¿è¡Œ
- **Paused**ï¼šå®¹å™¨å·²æš‚åœ
- **Restarting**ï¼šå®¹å™¨æ­£åœ¨é‡å¯
- **Removing**ï¼šå®¹å™¨æ­£åœ¨åˆ é™¤
- **Exited**ï¼šå®¹å™¨å·²é€€å‡º
- **Dead**ï¼šå®¹å™¨å·²æ­»äº¡

### æŸ¥çœ‹å®¹å™¨çŠ¶æ€

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps -a --format "table {{.Names}}\t{{.Status}}"

# æŸ¥çœ‹å®¹å™¨é€€å‡ºç 
docker inspect -f '{{.State.ExitCode}}' my-container
```

---

## å®¹å™¨æ—¥å¿—

### docker logs

æŸ¥çœ‹å®¹å™¨æ—¥å¿—ã€‚

```bash
# æŸ¥çœ‹æ—¥å¿—
docker logs my-container

# å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼ˆç±»ä¼¼ tail -fï¼‰
docker logs -f my-container

# æŸ¥çœ‹æœ€å N è¡Œ
docker logs --tail 100 my-container

# æŸ¥çœ‹å¸¦æ—¶é—´æˆ³çš„æ—¥å¿—
docker logs -t my-container

# æŸ¥çœ‹æŒ‡å®šæ—¶é—´èŒƒå›´çš„æ—¥å¿—
docker logs --since "2023-01-01T00:00:00" my-container
docker logs --until "2023-01-01T23:59:59" my-container

# æŸ¥çœ‹æœ€è¿‘ 10 åˆ†é’Ÿçš„æ—¥å¿—
docker logs --since 10m my-container
```

---

## å®¹å™¨æ–‡ä»¶æ“ä½œ

### docker cp

åœ¨å®¹å™¨å’Œæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¹‹é—´å¤åˆ¶æ–‡ä»¶ã€‚

```bash
# ä»å®¹å™¨å¤åˆ¶åˆ°æœ¬åœ°
docker cp my-container:/path/to/file /local/path

# ä»æœ¬åœ°å¤åˆ¶åˆ°å®¹å™¨
docker cp /local/path my-container:/path/to/file

# å¤åˆ¶ç›®å½•
docker cp my-container:/app ./app
```

---

## å®ç”¨æŠ€å·§

### æ‰¹é‡æ“ä½œ

```bash
# å¯åŠ¨æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨
docker start $(docker ps -a -q)

# åœæ­¢æ‰€æœ‰è¿è¡Œä¸­çš„å®¹å™¨
docker stop $(docker ps -q)

# åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨
docker rm $(docker ps -a -f "status=exited" -q)

# åˆ é™¤æ‰€æœ‰å®¹å™¨
docker rm -f $(docker ps -aq)
```

### å®¹å™¨æ¸…ç†

```bash
# åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨
docker container prune

# åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„å®¹å™¨ã€ç½‘ç»œã€é•œåƒ
docker system prune

# åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„èµ„æºï¼ˆåŒ…æ‹¬æœªä½¿ç”¨çš„é•œåƒï¼‰
docker system prune -a
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [Docker å®˜æ–¹æ–‡æ¡£ - å®¹å™¨ç®¡ç†](https://docs.docker.com/engine/reference/commandline/container/)
- [Docker å®˜æ–¹æ–‡æ¡£ - å®¹å™¨ç”Ÿå‘½å‘¨æœŸ](https://docs.docker.com/engine/reference/commandline/run/)

---

[[!MOC-Docker|è¿”å› Docker çŸ¥è¯†ä½“ç³»]]

#Docker #å®¹å™¨ #å®¹å™¨ç®¡ç†
