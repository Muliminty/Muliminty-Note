# Docker åŸºæœ¬å‘½ä»¤

> Docker å¸¸ç”¨å‘½ä»¤è¯¦è§£å’Œä½¿ç”¨ç¤ºä¾‹

---

## ğŸ“‹ ç›®å½•

- [ç³»ç»Ÿä¿¡æ¯å‘½ä»¤](#ç³»ç»Ÿä¿¡æ¯å‘½ä»¤)
- [é•œåƒå‘½ä»¤](#é•œåƒå‘½ä»¤)
- [å®¹å™¨å‘½ä»¤](#å®¹å™¨å‘½ä»¤)
- [ç½‘ç»œå‘½ä»¤](#ç½‘ç»œå‘½ä»¤)
- [æ•°æ®å·å‘½ä»¤](#æ•°æ®å·å‘½ä»¤)
- [å…¶ä»–å¸¸ç”¨å‘½ä»¤](#å…¶ä»–å¸¸ç”¨å‘½ä»¤)

---

## ç³»ç»Ÿä¿¡æ¯å‘½ä»¤

### docker version

æŸ¥çœ‹ Docker ç‰ˆæœ¬ä¿¡æ¯ã€‚

```bash
docker version
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
Client: Docker Engine - Community
 Version:           24.0.0
 API version:       1.43
 ...

Server: Docker Engine - Community
 Engine:
  Version:          24.0.0
  ...
```

### docker info

æŸ¥çœ‹ Docker ç³»ç»Ÿè¯¦ç»†ä¿¡æ¯ã€‚

```bash
docker info
```

æ˜¾ç¤ºä¿¡æ¯åŒ…æ‹¬ï¼š
- å®¹å™¨æ•°é‡
- é•œåƒæ•°é‡
- å­˜å‚¨é©±åŠ¨
- ç½‘ç»œé…ç½®
- ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ

---

## é•œåƒå‘½ä»¤

### docker images / docker image ls

åˆ—å‡ºæœ¬åœ°é•œåƒã€‚

```bash
# åˆ—å‡ºæ‰€æœ‰é•œåƒ
docker images

# åˆ—å‡ºæ‰€æœ‰é•œåƒï¼ˆåŒ…æ‹¬ä¸­é—´å±‚ï¼‰
docker images -a

# åªæ˜¾ç¤ºé•œåƒ ID
docker images -q

# æŒ‰æ ¼å¼è¾“å‡º
docker images --format "table {{.Repository}}\t{{.Tag}}\t{{.Size}}"
```

### docker pull

ä»ä»“åº“æ‹‰å–é•œåƒã€‚

```bash
# æ‹‰å–æœ€æ–°ç‰ˆæœ¬
docker pull nginx

# æ‹‰å–æŒ‡å®šç‰ˆæœ¬
docker pull nginx:1.21

# æ‹‰å–æŒ‡å®šä»“åº“çš„é•œåƒ
docker pull registry.example.com/myapp:latest
```

### docker push

æ¨é€é•œåƒåˆ°ä»“åº“ã€‚

```bash
# æ¨é€é•œåƒ
docker push username/myapp:v1.0

# æ¨é€å‰éœ€è¦å…ˆç™»å½•
docker login
```

### docker build

æ„å»ºé•œåƒã€‚

```bash
# ä½¿ç”¨å½“å‰ç›®å½•çš„ Dockerfile æ„å»º
docker build -t myapp:latest .

# æŒ‡å®š Dockerfile è·¯å¾„
docker build -f Dockerfile.prod -t myapp:prod .

# æ„å»ºæ—¶ä¸ä½¿ç”¨ç¼“å­˜
docker build --no-cache -t myapp:latest .

# ä¼ é€’æ„å»ºå‚æ•°
docker build --build-arg VERSION=1.0 -t myapp:latest .
```

### docker rmi / docker image rm

åˆ é™¤é•œåƒã€‚

```bash
# åˆ é™¤å•ä¸ªé•œåƒ
docker rmi nginx:1.21

# åˆ é™¤å¤šä¸ªé•œåƒ
docker rmi nginx:1.21 nginx:1.20

# å¼ºåˆ¶åˆ é™¤ï¼ˆå³ä½¿æœ‰å®¹å™¨ä½¿ç”¨ï¼‰
docker rmi -f nginx:1.21

# åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„é•œåƒ
docker image prune -a
```

### docker inspect

æŸ¥çœ‹é•œåƒè¯¦ç»†ä¿¡æ¯ã€‚

```bash
docker inspect nginx:latest

# æŸ¥çœ‹ç‰¹å®šä¿¡æ¯
docker inspect -f '{{.Config.Env}}' nginx:latest
```

---

## å®¹å™¨å‘½ä»¤

### docker run

åˆ›å»ºå¹¶è¿è¡Œå®¹å™¨ã€‚

```bash
# è¿è¡Œå®¹å™¨ï¼ˆå‰å°ï¼‰
docker run ubuntu:20.04 echo "Hello Docker"

# è¿è¡Œå®¹å™¨ï¼ˆåå°ï¼‰
docker run -d nginx

# è¿è¡Œå®¹å™¨ï¼ˆäº¤äº’å¼ï¼‰
docker run -it ubuntu:20.04 /bin/bash

# è¿è¡Œå®¹å™¨ï¼ˆæŒ‡å®šåç§°ï¼‰
docker run -d --name my-nginx nginx

# è¿è¡Œå®¹å™¨ï¼ˆç«¯å£æ˜ å°„ï¼‰
docker run -d -p 8080:80 nginx

# è¿è¡Œå®¹å™¨ï¼ˆæŒ‚è½½æ•°æ®å·ï¼‰
docker run -d -v /host/path:/container/path nginx

# è¿è¡Œå®¹å™¨ï¼ˆç¯å¢ƒå˜é‡ï¼‰
docker run -d -e ENV_VAR=value nginx

# è¿è¡Œå®¹å™¨ï¼ˆè‡ªåŠ¨åˆ é™¤ï¼‰
docker run --rm ubuntu:20.04 echo "Hello"

# è¿è¡Œå®¹å™¨ï¼ˆèµ„æºé™åˆ¶ï¼‰
docker run -d --memory="512m" --cpus="1.0" nginx
```

å¸¸ç”¨å‚æ•°ï¼š
- `-d`ï¼šåå°è¿è¡Œï¼ˆdetachedï¼‰
- `-it`ï¼šäº¤äº’å¼è¿è¡Œï¼ˆinteractive + TTYï¼‰
- `-p`ï¼šç«¯å£æ˜ å°„ï¼ˆhost:containerï¼‰
- `-v`ï¼šæ•°æ®å·æŒ‚è½½
- `-e`ï¼šç¯å¢ƒå˜é‡
- `--name`ï¼šå®¹å™¨åç§°
- `--rm`ï¼šå®¹å™¨åœæ­¢åè‡ªåŠ¨åˆ é™¤
- `--restart`ï¼šé‡å¯ç­–ç•¥

### docker ps / docker container ls

åˆ—å‡ºå®¹å™¨ã€‚

```bash
# åˆ—å‡ºè¿è¡Œä¸­çš„å®¹å™¨
docker ps

# åˆ—å‡ºæ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬å·²åœæ­¢çš„ï¼‰
docker ps -a

# åªæ˜¾ç¤ºå®¹å™¨ ID
docker ps -q

# æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨
docker ps -l

# æŒ‰æ ¼å¼è¾“å‡º
docker ps --format "table {{.ID}}\t{{.Names}}\t{{.Status}}"
```

### docker start

å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨ã€‚

```bash
# å¯åŠ¨å®¹å™¨
docker start <container_id>

# å¯åŠ¨å¤šä¸ªå®¹å™¨
docker start container1 container2

# å¯åŠ¨å¹¶é™„åŠ åˆ°å®¹å™¨
docker start -a <container_id>
```

### docker stop

åœæ­¢è¿è¡Œä¸­çš„å®¹å™¨ã€‚

```bash
# åœæ­¢å®¹å™¨
docker stop <container_id>

# åœæ­¢å¤šä¸ªå®¹å™¨
docker stop container1 container2

# å¼ºåˆ¶åœæ­¢ï¼ˆå‘é€ SIGKILLï¼‰
docker stop -t 0 <container_id>
```

### docker restart

é‡å¯å®¹å™¨ã€‚

```bash
docker restart <container_id>
```

### docker rm / docker container rm

åˆ é™¤å®¹å™¨ã€‚

```bash
# åˆ é™¤å·²åœæ­¢çš„å®¹å™¨
docker rm <container_id>

# å¼ºåˆ¶åˆ é™¤è¿è¡Œä¸­çš„å®¹å™¨
docker rm -f <container_id>

# åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨
docker container prune

# åˆ é™¤æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬è¿è¡Œä¸­çš„ï¼‰
docker rm -f $(docker ps -aq)
```

### docker exec

åœ¨è¿è¡Œä¸­çš„å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤ã€‚

```bash
# æ‰§è¡Œå‘½ä»¤
docker exec <container_id> ls /app

# äº¤äº’å¼æ‰§è¡Œï¼ˆè¿›å…¥å®¹å™¨ï¼‰
docker exec -it <container_id> /bin/bash

# ä»¥ root ç”¨æˆ·æ‰§è¡Œ
docker exec -u root <container_id> command
```

### docker logs

æŸ¥çœ‹å®¹å™¨æ—¥å¿—ã€‚

```bash
# æŸ¥çœ‹æ—¥å¿—
docker logs <container_id>

# å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼ˆç±»ä¼¼ tail -fï¼‰
docker logs -f <container_id>

# æŸ¥çœ‹æœ€å N è¡Œ
docker logs --tail 100 <container_id>

# æŸ¥çœ‹å¸¦æ—¶é—´æˆ³çš„æ—¥å¿—
docker logs -t <container_id>

# æŸ¥çœ‹æŒ‡å®šæ—¶é—´èŒƒå›´çš„æ—¥å¿—
docker logs --since "2023-01-01T00:00:00" <container_id>
```

### docker inspect

æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯ã€‚

```bash
# æŸ¥çœ‹å®¹å™¨ä¿¡æ¯
docker inspect <container_id>

# æŸ¥çœ‹ç‰¹å®šä¿¡æ¯
docker inspect -f '{{.NetworkSettings.IPAddress}}' <container_id>
docker inspect -f '{{.Config.Env}}' <container_id>
```

### docker stats

å®æ—¶æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µã€‚

```bash
# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çš„èµ„æºä½¿ç”¨
docker stats

# æŸ¥çœ‹æŒ‡å®šå®¹å™¨
docker stats <container_id>

# åªæ˜¾ç¤ºä¸€æ¬¡ï¼ˆä¸æŒç»­æ›´æ–°ï¼‰
docker stats --no-stream
```

---

## ç½‘ç»œå‘½ä»¤

### docker network ls

åˆ—å‡ºç½‘ç»œã€‚

```bash
docker network ls
```

### docker network create

åˆ›å»ºç½‘ç»œã€‚

```bash
# åˆ›å»ºæ¡¥æ¥ç½‘ç»œ
docker network create my-network

# åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œ
docker network create --driver bridge --subnet=172.20.0.0/16 my-network
```

### docker network connect

å°†å®¹å™¨è¿æ¥åˆ°ç½‘ç»œã€‚

```bash
docker network connect my-network <container_id>
```

### docker network disconnect

æ–­å¼€å®¹å™¨ä¸ç½‘ç»œçš„è¿æ¥ã€‚

```bash
docker network disconnect my-network <container_id>
```

### docker network inspect

æŸ¥çœ‹ç½‘ç»œè¯¦ç»†ä¿¡æ¯ã€‚

```bash
docker network inspect my-network
```

---

## æ•°æ®å·å‘½ä»¤

### docker volume ls

åˆ—å‡ºæ•°æ®å·ã€‚

```bash
docker volume ls
```

### docker volume create

åˆ›å»ºæ•°æ®å·ã€‚

```bash
docker volume create my-volume
```

### docker volume inspect

æŸ¥çœ‹æ•°æ®å·è¯¦ç»†ä¿¡æ¯ã€‚

```bash
docker volume inspect my-volume
```

### docker volume rm

åˆ é™¤æ•°æ®å·ã€‚

```bash
# åˆ é™¤æ•°æ®å·
docker volume rm my-volume

# åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„æ•°æ®å·
docker volume prune
```

---

## å…¶ä»–å¸¸ç”¨å‘½ä»¤

### docker search

åœ¨ Docker Hub æœç´¢é•œåƒã€‚

```bash
docker search nginx

# é™åˆ¶æœç´¢ç»“æœæ•°é‡
docker search --limit 5 nginx
```

### docker tag

ç»™é•œåƒæ‰“æ ‡ç­¾ã€‚

```bash
# åˆ›å»ºæ–°æ ‡ç­¾
docker tag nginx:latest nginx:1.21

# æ ‡è®°é•œåƒå‡†å¤‡æ¨é€
docker tag myapp:latest username/myapp:v1.0
```

### docker cp

åœ¨å®¹å™¨å’Œæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¹‹é—´å¤åˆ¶æ–‡ä»¶ã€‚

```bash
# ä»å®¹å™¨å¤åˆ¶åˆ°æœ¬åœ°
docker cp <container_id>:/path/to/file /local/path

# ä»æœ¬åœ°å¤åˆ¶åˆ°å®¹å™¨
docker cp /local/path <container_id>:/path/to/file
```

### docker commit

åŸºäºå®¹å™¨åˆ›å»ºæ–°é•œåƒã€‚

```bash
docker commit <container_id> new-image:tag
```

### docker save / docker load

å¯¼å‡ºå’Œå¯¼å…¥é•œåƒã€‚

```bash
# å¯¼å‡ºé•œåƒåˆ°æ–‡ä»¶
docker save -o nginx.tar nginx:latest

# ä»æ–‡ä»¶å¯¼å…¥é•œåƒ
docker load -i nginx.tar
```

### docker export / docker import

å¯¼å‡ºå’Œå¯¼å…¥å®¹å™¨ã€‚

```bash
# å¯¼å‡ºå®¹å™¨åˆ°æ–‡ä»¶
docker export <container_id> > container.tar

# ä»æ–‡ä»¶å¯¼å…¥ä¸ºé•œåƒ
docker import container.tar new-image:tag
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [Docker å®˜æ–¹æ–‡æ¡£ - å‘½ä»¤å‚è€ƒ](https://docs.docker.com/reference/)
- [Docker CLI å®Œæ•´å‘½ä»¤åˆ—è¡¨](https://docs.docker.com/engine/reference/commandline/cli/)

---

[[!MOC-Docker|è¿”å› Docker çŸ¥è¯†ä½“ç³»]]

#Docker #å‘½ä»¤ #CLI

