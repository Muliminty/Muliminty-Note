# è…¾è®¯äº‘éƒ¨ç½²æŒ‡å—ï¼ˆTencent Cloud Deploymentï¼‰

> è…¾è®¯äº‘è½»é‡åº”ç”¨æœåŠ¡å™¨éƒ¨ç½²å®Œæ•´å®è·µæŒ‡å—
> 
> **é€‚ç”¨åœºæ™¯**ï¼šè…¾è®¯äº‘è½»é‡æœåŠ¡å™¨ + ä¸€ä¸ªåŸŸå + å¤šé¡¹ç›®éƒ¨ç½²
> 
> **å­¦ä¹ ç›®æ ‡**ï¼š
> - æŒæ¡æœåŠ¡å™¨ç¯å¢ƒé…ç½®
> - æŒæ¡ Nginx å¤šé¡¹ç›®é…ç½®
> - æŒæ¡ HTTPS è¯ä¹¦ç”³è¯·
> - æŒæ¡ Node.js åº”ç”¨éƒ¨ç½²

---

## ğŸ“‹ ç›®å½•

- [ä¸€ã€æœåŠ¡å™¨ä¸åŸŸåå‡†å¤‡](#ä¸€æœåŠ¡å™¨ä¸åŸŸåå‡†å¤‡)
- [äºŒã€æœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡](#äºŒæœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡)
- [ä¸‰ã€é¡¹ç›®ç›®å½•ç»“æ„](#ä¸‰é¡¹ç›®ç›®å½•ç»“æ„)
- [å››ã€Nginx é…ç½®è¯¦è§£](#å››nginx-é…ç½®è¯¦è§£)
- [äº”ã€HTTPS è¯ä¹¦ç”³è¯·](#äº”https-è¯ä¹¦ç”³è¯·)
- [å…­ã€Node.js åº”ç”¨éƒ¨ç½²](#å…­nodejs-åº”ç”¨éƒ¨ç½²)
- [ä¸ƒã€éƒ¨ç½²æ£€æŸ¥æ¸…å•](#ä¸ƒéƒ¨ç½²æ£€æŸ¥æ¸…å•)
- [å…«ã€å¸¸è§é—®é¢˜æ’æŸ¥](#å…«å¸¸è§é—®é¢˜æ’æŸ¥)
- [ä¹ã€æ‰©å±•ä¸ä¼˜åŒ–](#ä¹æ‰©å±•ä¸ä¼˜åŒ–)

---

## ä¸€ã€æœåŠ¡å™¨ä¸åŸŸåå‡†å¤‡

### 1.1 æœåŠ¡å™¨é…ç½®

**æ¨èé…ç½®**ï¼š
- **ç³»ç»Ÿ**ï¼šUbuntu 20.04 æˆ– CentOS 7/8
- **é…ç½®**ï¼š2 æ ¸ 4G å†…å­˜
- **ç«¯å£**ï¼šéœ€è¦å¼€æ”¾ä»¥ä¸‹ç«¯å£
  - `22` - SSH
  - `80` - HTTP
  - `443` - HTTPS

**ç«¯å£å¼€æ”¾**ï¼š
åœ¨è…¾è®¯äº‘æ§åˆ¶å° â†’ å®‰å…¨ç»„ â†’ å…¥ç«™è§„åˆ™ä¸­æ·»åŠ ä»¥ä¸Šç«¯å£ã€‚

---

### 1.2 åŸŸåé…ç½®

**åŸŸåç¤ºä¾‹**ï¼š`muliminty.site`

**DNS è§£æé…ç½®**ï¼š
åœ¨è…¾è®¯äº‘åŸŸåæ§åˆ¶å° â†’ DNS è§£æä¸­é…ç½®ï¼š

| ä¸»æœºè®°å½• | è®°å½•ç±»å‹ | è®°å½•å€¼ | è¯´æ˜ |
|---------|---------|--------|------|
| @ | A | æœåŠ¡å™¨å…¬ç½‘IP | ä¸»åŸŸå |
| cv | A | æœåŠ¡å™¨å…¬ç½‘IP | å­åŸŸåï¼šcv.muliminty.site |
| note | A | æœåŠ¡å™¨å…¬ç½‘IP | å­åŸŸåï¼šnote.muliminty.site |

> **æ³¨æ„**ï¼šDNS è§£æç”Ÿæ•ˆå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿåˆ°å‡ ä¸ªå°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `ping` å‘½ä»¤æ£€æŸ¥è§£ææ˜¯å¦ç”Ÿæ•ˆã€‚

**éªŒè¯ DNS è§£æ**ï¼š
```bash
# æ£€æŸ¥åŸŸåè§£æ
ping muliminty.site
ping cv.muliminty.site
ping note.muliminty.site
```

---

## äºŒã€æœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡

### 2.1 ç³»ç»Ÿæ›´æ–°

```bash
# Ubuntu
sudo apt update && sudo apt upgrade -y

# CentOS
sudo yum update -y
```

---

### 2.2 å®‰è£… Nginx

```bash
# Ubuntu
sudo apt install nginx -y

# CentOS
sudo yum install epel-release -y
sudo yum install nginx -y
```

**å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯**ï¼š
```bash
sudo systemctl start nginx
sudo systemctl enable nginx
sudo systemctl status nginx
```

**éªŒè¯å®‰è£…**ï¼š
```bash
# æ£€æŸ¥ Nginx ç‰ˆæœ¬
nginx -v

# æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•
sudo nginx -t
```

---

### 2.3 å®‰è£… Node.jsï¼ˆå¯é€‰ï¼‰

å¦‚æœé¡¹ç›®ä¸­æœ‰ Node.js åº”ç”¨ï¼Œæ¨èä½¿ç”¨ nvm å®‰è£…ï¼š

```bash
# å®‰è£… nvm
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.5/install.sh | bash

# é‡æ–°åŠ è½½ shell é…ç½®
source ~/.bashrc

# å®‰è£… Node.js LTS ç‰ˆæœ¬
nvm install --lts
nvm use --lts

# éªŒè¯å®‰è£…
node -v
npm -v
```

---

### 2.4 å®‰è£… PM2ï¼ˆNode.js è¿›ç¨‹ç®¡ç†ï¼‰

```bash
# å…¨å±€å®‰è£… PM2
npm install pm2 -g

# éªŒè¯å®‰è£…
pm2 -v

# è®¾ç½® PM2 å¼€æœºè‡ªå¯ï¼ˆå¯é€‰ï¼‰
pm2 startup
pm2 save
```

---

## ä¸‰ã€é¡¹ç›®ç›®å½•ç»“æ„

### 3.1 åˆ›å»ºé¡¹ç›®ç›®å½•

åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºç»Ÿä¸€çš„é¡¹ç›®ç›®å½•ï¼š

```bash
# åˆ›å»ºé¡¹ç›®ç›®å½•
sudo mkdir -p /var/www/muliminty.site
sudo mkdir -p /var/www/cv.muliminty.site
sudo mkdir -p /var/www/note.muliminty.site

# è®¾ç½®ç›®å½•æƒé™ï¼ˆæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼‰
sudo chown -R $USER:$USER /var/www/*
```

**ç›®å½•è¯´æ˜**ï¼š
- `/var/www/muliminty.site` â†’ ä¸»ç«™é¡¹ç›®
- `/var/www/cv.muliminty.site` â†’ ä¸ªäººç®€å†é¡¹ç›®
- `/var/www/note.muliminty.site` â†’ ç¬”è®°ç³»ç»Ÿé¡¹ç›®

---

### 3.2 ä¸Šä¼ é¡¹ç›®æ–‡ä»¶

**æ–¹å¼ä¸€ï¼šä½¿ç”¨ SCP ä¸Šä¼ **
```bash
# ä»æœ¬åœ°ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp -r ./project/* user@your-server-ip:/var/www/muliminty.site/
```

**æ–¹å¼äºŒï¼šä½¿ç”¨ Git å…‹éš†**
```bash
# SSH åˆ°æœåŠ¡å™¨åæ‰§è¡Œ
cd /var/www/muliminty.site
git clone https://github.com/your-username/your-repo.git .
```

**æ–¹å¼ä¸‰ï¼šä½¿ç”¨ FTP/SFTP å·¥å…·**
- ä½¿ç”¨ FileZillaã€WinSCP ç­‰å·¥å…·ä¸Šä¼ æ–‡ä»¶

---

## å››ã€Nginx é…ç½®è¯¦è§£

### 4.1 Nginx é…ç½®æ–‡ä»¶ä½ç½®

ä¸åŒç³»ç»Ÿçš„é…ç½®æ–‡ä»¶ä½ç½®ï¼š

| ç³»ç»Ÿ | ä¸»é…ç½®æ–‡ä»¶ | è™šæ‹Ÿä¸»æœºé…ç½®ç›®å½• | è¯´æ˜ |
|------|-----------|----------------|------|
| **Ubuntu** | `/etc/nginx/nginx.conf` | `/etc/nginx/sites-available/`<br>`/etc/nginx/sites-enabled/` | ä½¿ç”¨ `sites-available` ç®¡ç†æ‰€æœ‰ç«™ç‚¹ï¼Œ`sites-enabled` é€šè¿‡è½¯é“¾æ¥å¯ç”¨ |
| **CentOS** | `/etc/nginx/nginx.conf` | `/etc/nginx/conf.d/` | æ¯ä¸ªç«™ç‚¹å•ç‹¬ `*.conf` æ–‡ä»¶ï¼Œè‡ªåŠ¨åŠ è½½ |

---

### 4.2 Ubuntu é…ç½®ç¤ºä¾‹

#### åˆ›å»ºé…ç½®æ–‡ä»¶

```bash
sudo nano /etc/nginx/sites-available/muliminty.conf
```

#### é…ç½®å†…å®¹

```nginx
# ä¸»ç«™ muliminty.site
server {
    listen 80;
    server_name muliminty.site www.muliminty.site;

    root /var/www/muliminty.site;
    index index.html index.htm;

    # æ—¥å¿—é…ç½®
    access_log /var/log/nginx/muliminty.access.log;
    error_log /var/log/nginx/muliminty.error.log;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(jpg|jpeg|png|gif|ico|css|js|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}

# cv.muliminty.site
server {
    listen 80;
    server_name cv.muliminty.site;

    root /var/www/cv.muliminty.site;
    index index.html index.htm;

    access_log /var/log/nginx/cv.access.log;
    error_log /var/log/nginx/cv.error.log;

    location / {
        try_files $uri $uri/ /index.html;
    }
}

# note.muliminty.siteï¼ˆé™æ€é¡¹ç›®ï¼‰
server {
    listen 80;
    server_name note.muliminty.site;

    root /var/www/note.muliminty.site;
    index index.html index.htm;

    access_log /var/log/nginx/note.access.log;
    error_log /var/log/nginx/note.error.log;

    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

#### å¯ç”¨ç«™ç‚¹

```bash
# åˆ›å»ºè½¯é“¾æ¥å¯ç”¨ç«™ç‚¹
sudo ln -s /etc/nginx/sites-available/muliminty.conf /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®æ–‡ä»¶è¯­æ³•
sudo nginx -t

# é‡æ–°åŠ è½½ Nginx
sudo systemctl reload nginx
```

---

### 4.3 CentOS é…ç½®ç¤ºä¾‹

#### åˆ›å»ºé…ç½®æ–‡ä»¶

```bash
sudo nano /etc/nginx/conf.d/muliminty.conf
```

é…ç½®å†…å®¹ä¸ Ubuntu ç›¸åŒï¼Œ**æ— éœ€è½¯é“¾æ¥**ï¼ŒNginx ä¼šè‡ªåŠ¨åŠ è½½ `/etc/nginx/conf.d/*.conf`ã€‚

---

### 4.4 éªŒè¯é…ç½®

```bash
# æµ‹è¯•é…ç½®æ–‡ä»¶è¯­æ³•
sudo nginx -t

# é‡æ–°åŠ è½½é…ç½®
sudo systemctl reload nginx

# æŸ¥çœ‹ Nginx çŠ¶æ€
sudo systemctl status nginx

# æŸ¥çœ‹é…ç½®çš„ç«™ç‚¹
sudo nginx -T | grep server_name
```

---

## äº”ã€HTTPS è¯ä¹¦ç”³è¯·

### 5.1 ä½¿ç”¨ Let's Encrypt å…è´¹è¯ä¹¦

#### å®‰è£… Certbot

```bash
# Ubuntu
sudo apt install certbot python3-certbot-nginx -y

# CentOS
sudo yum install certbot python3-certbot-nginx -y
```

#### ç”³è¯·è¯ä¹¦

**æ–¹å¼ä¸€ï¼šæ‰¹é‡ç”³è¯·å¤šä¸ªåŸŸåè¯ä¹¦**
```bash
sudo certbot --nginx -d muliminty.site -d www.muliminty.site -d cv.muliminty.site -d note.muliminty.site
```

**æ–¹å¼äºŒï¼šé€ä¸ªç”³è¯·å•åŸŸåè¯ä¹¦**
```bash
sudo certbot --nginx -d muliminty.site
sudo certbot --nginx -d cv.muliminty.site
sudo certbot --nginx -d note.muliminty.site
```

#### è¯ä¹¦è‡ªåŠ¨ç»­æœŸ

Let's Encrypt è¯ä¹¦æœ‰æ•ˆæœŸä¸º 90 å¤©ï¼ŒCertbot ä¼šè‡ªåŠ¨é…ç½®ç»­æœŸä»»åŠ¡ï¼š

```bash
# æ£€æŸ¥è‡ªåŠ¨ç»­æœŸä»»åŠ¡
sudo systemctl status certbot.timer

# æ‰‹åŠ¨æµ‹è¯•ç»­æœŸ
sudo certbot renew --dry-run
```

---

### 5.2 é…ç½® HTTP è‡ªåŠ¨è·³è½¬ HTTPS

Certbot ä¼šè‡ªåŠ¨ä¿®æ”¹ Nginx é…ç½®ï¼Œæ·»åŠ  HTTPS é…ç½®å’Œ HTTP è·³è½¬ã€‚å¦‚æœéœ€è¦æ‰‹åŠ¨é…ç½®ï¼š

```nginx
# HTTP è‡ªåŠ¨è·³è½¬åˆ° HTTPS
server {
    listen 80;
    server_name muliminty.site www.muliminty.site;
    return 301 https://$server_name$request_uri;
}

# HTTPS é…ç½®
server {
    listen 443 ssl http2;
    server_name muliminty.site www.muliminty.site;

    ssl_certificate /etc/letsencrypt/live/muliminty.site/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/muliminty.site/privkey.pem;

    root /var/www/muliminty.site;
    index index.html index.htm;

    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

---

## å…­ã€Node.js åº”ç”¨éƒ¨ç½²

### 6.1 åå‘ä»£ç†é…ç½®

å¦‚æœ `note` é¡¹ç›®æ˜¯ Node.js æœåŠ¡ï¼Œè¿è¡Œåœ¨ 3000 ç«¯å£ï¼š

```nginx
server {
    listen 80;
    server_name note.muliminty.site;

    location / {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

---

### 6.2 ä½¿ç”¨ PM2 å¯åŠ¨ Node.js åº”ç”¨

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /var/www/note.muliminty.site

# å®‰è£…ä¾èµ–
npm install

# ä½¿ç”¨ PM2 å¯åŠ¨åº”ç”¨
pm2 start index.js --name note

# æˆ–è€…ä½¿ç”¨ PM2 é…ç½®æ–‡ä»¶
pm2 start ecosystem.config.js

# æŸ¥çœ‹åº”ç”¨çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs note

# ä¿å­˜ PM2 è¿›ç¨‹åˆ—è¡¨
pm2 save

# è®¾ç½® PM2 å¼€æœºè‡ªå¯ï¼ˆé¦–æ¬¡éœ€è¦æ‰§è¡Œï¼‰
pm2 startup
```

---

### 6.3 PM2 å¸¸ç”¨å‘½ä»¤

```bash
# å¯åŠ¨åº”ç”¨
pm2 start app.js --name myapp

# åœæ­¢åº”ç”¨
pm2 stop myapp

# é‡å¯åº”ç”¨
pm2 restart myapp

# åˆ é™¤åº”ç”¨
pm2 delete myapp

# æŸ¥çœ‹æ‰€æœ‰åº”ç”¨
pm2 list

# æŸ¥çœ‹æ—¥å¿—
pm2 logs myapp

# ç›‘æ§åº”ç”¨
pm2 monit

# ä¿å­˜è¿›ç¨‹åˆ—è¡¨
pm2 save
```

---

## ä¸ƒã€éƒ¨ç½²æ£€æŸ¥æ¸…å•

### âœ… éƒ¨ç½²å‰æ£€æŸ¥

- [ ] æœåŠ¡å™¨ç«¯å£å·²å¼€æ”¾ï¼ˆ22ã€80ã€443ï¼‰
- [ ] åŸŸå DNS è§£æå·²é…ç½®
- [ ] æœåŠ¡å™¨ç¯å¢ƒå·²å‡†å¤‡ï¼ˆNginxã€Node.jsï¼‰
- [ ] é¡¹ç›®æ–‡ä»¶å·²ä¸Šä¼ åˆ°æœåŠ¡å™¨

### âœ… éƒ¨ç½²åæ£€æŸ¥

- [ ] Nginx é…ç½®æ–‡ä»¶è¯­æ³•æ­£ç¡®ï¼ˆ`nginx -t`ï¼‰
- [ ] Nginx æœåŠ¡æ­£å¸¸è¿è¡Œï¼ˆ`systemctl status nginx`ï¼‰
- [ ] æ‰€æœ‰åŸŸåå¯ä»¥æ­£å¸¸è®¿é—®
- [ ] HTTPS è¯ä¹¦å·²ç”³è¯·å¹¶é…ç½®
- [ ] HTTP è‡ªåŠ¨è·³è½¬åˆ° HTTPS
- [ ] Node.js åº”ç”¨æ­£å¸¸è¿è¡Œï¼ˆå¦‚æœé€‚ç”¨ï¼‰
- [ ] PM2 è¿›ç¨‹ç®¡ç†æ­£å¸¸ï¼ˆå¦‚æœé€‚ç”¨ï¼‰
- [ ] æ—¥å¿—æ–‡ä»¶æ­£å¸¸ç”Ÿæˆ

---

## å…«ã€å¸¸è§é—®é¢˜æ’æŸ¥

### 8.1 Nginx ç›¸å…³

**é—®é¢˜ 1ï¼šNginx æ— æ³•å¯åŠ¨**
```bash
# æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•
sudo nginx -t

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log

# æŸ¥çœ‹ Nginx çŠ¶æ€
sudo systemctl status nginx
```

**é—®é¢˜ 2ï¼š403 Forbidden é”™è¯¯**
```bash
# æ£€æŸ¥ç›®å½•æƒé™
ls -la /var/www/

# æ£€æŸ¥ Nginx ç”¨æˆ·æƒé™
sudo chown -R www-data:www-data /var/www/muliminty.site
sudo chmod -R 755 /var/www/muliminty.site
```

**é—®é¢˜ 3ï¼š502 Bad Gateway é”™è¯¯**
- æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
- æ£€æŸ¥åå‘ä»£ç†é…ç½®æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨

---

### 8.2 åŸŸåå’Œè¯ä¹¦ç›¸å…³

**é—®é¢˜ 1ï¼šåŸŸåæ— æ³•è®¿é—®**
```bash
# æ£€æŸ¥ DNS è§£æ
ping muliminty.site
nslookup muliminty.site

# æ£€æŸ¥ Nginx é…ç½®
sudo nginx -T | grep server_name
```

**é—®é¢˜ 2ï¼šHTTPS è¯ä¹¦ç”³è¯·å¤±è´¥**
- ç¡®ä¿åŸŸåè§£æå·²ç”Ÿæ•ˆ
- ç¡®ä¿ 80 ç«¯å£å·²å¼€æ”¾
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

---

### 8.3 Node.js åº”ç”¨ç›¸å…³

**é—®é¢˜ 1ï¼šPM2 åº”ç”¨æ— æ³•å¯åŠ¨**
```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
pm2 logs note

# æ£€æŸ¥ Node.js ç‰ˆæœ¬
node -v

# æ£€æŸ¥ä¾èµ–å®‰è£…
cd /var/www/note.muliminty.site
npm install
```

**é—®é¢˜ 2ï¼šåº”ç”¨å¯åŠ¨åæ— æ³•è®¿é—®**
- æ£€æŸ¥åº”ç”¨ç›‘å¬çš„ç«¯å£
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- æ£€æŸ¥ Nginx åå‘ä»£ç†é…ç½®

---

## ä¹ã€æ‰©å±•ä¸ä¼˜åŒ–

### 9.1 æ–°å¢é¡¹ç›®éƒ¨ç½²æ­¥éª¤

1. **åˆ›å»ºé¡¹ç›®ç›®å½•**
   ```bash
   sudo mkdir -p /var/www/newproject.site
   ```

2. **ä¸Šä¼ é¡¹ç›®æ–‡ä»¶**
   ```bash
   # ä½¿ç”¨ SCPã€Git æˆ– FTP ä¸Šä¼ 
   ```

3. **é…ç½® DNS è§£æ**
   - åœ¨åŸŸåæ§åˆ¶å°æ·»åŠ æ–°çš„ A è®°å½•

4. **åˆ›å»º Nginx é…ç½®**
   ```bash
   # Ubuntu
   sudo nano /etc/nginx/sites-available/newproject.conf
   
   # CentOS
   sudo nano /etc/nginx/conf.d/newproject.conf
   ```

5. **å¯ç”¨é…ç½®**
   ```bash
   # Ubuntu
   sudo ln -s /etc/nginx/sites-available/newproject.conf /etc/nginx/sites-enabled/
   
   # æµ‹è¯•å¹¶é‡è½½
   sudo nginx -t && sudo systemctl reload nginx
   ```

6. **ç”³è¯· HTTPSï¼ˆå¯é€‰ï¼‰**
   ```bash
   sudo certbot --nginx -d newproject.site
   ```

---

### 9.2 æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### Nginx æ€§èƒ½ä¼˜åŒ–

```nginx
# åœ¨ nginx.conf ä¸­æ·»åŠ 
worker_processes auto;
worker_connections 1024;

# Gzip å‹ç¼©
gzip on;
gzip_vary on;
gzip_min_length 1024;
gzip_types text/plain text/css text/xml text/javascript application/javascript application/json;
```

#### é™æ€èµ„æºç¼“å­˜

```nginx
location ~* \.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2|ttf|eot)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
    access_log off;
}
```

---

### 9.3 å®‰å…¨åŠ å›º

#### 1. é˜²ç«å¢™é…ç½®

```bash
# ä½¿ç”¨ UFWï¼ˆUbuntuï¼‰
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable

# ä½¿ç”¨ firewalldï¼ˆCentOSï¼‰
sudo firewall-cmd --permanent --add-service=ssh
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --reload
```

#### 2. SSH å®‰å…¨é…ç½®

```bash
# ç¼–è¾‘ SSH é…ç½®
sudo nano /etc/ssh/sshd_config

# å»ºè®®ä¿®æ”¹ï¼š
# - ç¦ç”¨ root ç™»å½•
# - ä¿®æ”¹ SSH ç«¯å£
# - ä½¿ç”¨å¯†é’¥è®¤è¯
```

#### 3. Nginx å®‰å…¨å¤´éƒ¨

```nginx
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "no-referrer-when-downgrade" always;
```

---

### 9.4 ç›‘æ§ä¸æ—¥å¿—

#### æ—¥å¿—ç®¡ç†

```bash
# æŸ¥çœ‹è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/access.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log

# æ—¥å¿—è½®è½¬é…ç½®ï¼ˆè‡ªåŠ¨ï¼‰
# Ubuntu: /etc/logrotate.d/nginx
# CentOS: /etc/logrotate.d/nginx
```

#### PM2 ç›‘æ§

```bash
# ç›‘æ§åº”ç”¨
pm2 monit

# æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
pm2 show note

# è®¾ç½®æ—¥å¿—è½®è½¬
pm2 install pm2-logrotate
```

---

## ğŸ“š ç›¸å…³èµ„æº

### å®˜æ–¹æ–‡æ¡£
- [Nginx å®˜æ–¹æ–‡æ¡£](https://nginx.org/en/docs/)
- [Let's Encrypt æ–‡æ¡£](https://letsencrypt.org/docs/)
- [PM2 å®˜æ–¹æ–‡æ¡£](https://pm2.keymetrics.io/docs/)
- [è…¾è®¯äº‘æ–‡æ¡£](https://cloud.tencent.com/document/product)

### ç›¸å…³é“¾æ¥
- [Nginx çŸ¥è¯†ä½“ç³»](../../02-WebæœåŠ¡å™¨/nginx/!MOC-nginx.md) â€” Nginx å®Œæ•´é…ç½®æŒ‡å—
- [æœåŠ¡ç«¯çŸ¥è¯†ä½“ç³»](../../!MOC-æœåŠ¡ç«¯.md) â€” æœåŠ¡ç«¯å®Œæ•´çŸ¥è¯†ä½“ç³»
- [éƒ¨ç½²ä¸å‘å¸ƒ](../../../00-å‰ç«¯ä½“ç³»/05-é«˜çº§åº”ç”¨/éƒ¨ç½²ä¸å‘å¸ƒ/!MOC-éƒ¨ç½²ä¸å‘å¸ƒ.md) â€” å‰ç«¯éƒ¨ç½²æ–¹æ¡ˆ

---

## ğŸ¯ å­¦ä¹ æ£€æŸ¥ç‚¹

å®Œæˆéƒ¨ç½²åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

- âœ… åœ¨äº‘æœåŠ¡å™¨ä¸Šé…ç½® Nginx
- âœ… é…ç½®å¤šä¸ªå­åŸŸåé¡¹ç›®
- âœ… ç”³è¯·å’Œé…ç½® HTTPS è¯ä¹¦
- âœ… éƒ¨ç½²é™æ€é¡¹ç›®
- âœ… éƒ¨ç½² Node.js åº”ç”¨ï¼ˆä½¿ç”¨ PM2ï¼‰
- âœ… æ’æŸ¥å¸¸è§çš„éƒ¨ç½²é—®é¢˜
- âœ… è¿›è¡ŒåŸºæœ¬çš„æ€§èƒ½ä¼˜åŒ–å’Œå®‰å…¨åŠ å›º

---

**æœ€åæ›´æ–°**ï¼š2024  
**é€‚ç”¨å¹³å°**ï¼šè…¾è®¯äº‘è½»é‡åº”ç”¨æœåŠ¡å™¨

---

#æœåŠ¡ç«¯ #éƒ¨ç½² #è…¾è®¯äº‘ #nginx #pm2 #https
