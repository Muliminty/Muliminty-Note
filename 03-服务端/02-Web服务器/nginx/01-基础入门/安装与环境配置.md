# Nginx å®‰è£…ä¸ŽçŽ¯å¢ƒé…ç½®

> Nginx åœ¨ä¸åŒå¹³å°çš„å®‰è£…æ–¹æ³•å’ŒçŽ¯å¢ƒé…ç½®

---

## ðŸ“‹ ç›®å½•

- [Linux å®‰è£…](#linux-å®‰è£…)
- [macOS å®‰è£…](#macos-å®‰è£…)
- [Windows å®‰è£…](#windows-å®‰è£…)
- [æºç ç¼–è¯‘å®‰è£…](#æºç ç¼–è¯‘å®‰è£…)
- [éªŒè¯å®‰è£…](#éªŒè¯å®‰è£…)
- [çŽ¯å¢ƒé…ç½®](#çŽ¯å¢ƒé…ç½®)

---

## Linux å®‰è£…

### Ubuntu/Debian

```bash
# æ›´æ–°åŒ…ç´¢å¼•
sudo apt update

# å®‰è£… Nginx
sudo apt install nginx

# å¯åŠ¨ Nginx
sudo systemctl start nginx

# è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl enable nginx
```

### CentOS/RHEL

```bash
# å®‰è£… EPEL ä»“åº“
sudo yum install epel-release

# å®‰è£… Nginx
sudo yum install nginx

# å¯åŠ¨ Nginx
sudo systemctl start nginx

# è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl enable nginx
```

### ä½¿ç”¨å®˜æ–¹ä»“åº“å®‰è£…æœ€æ–°ç‰ˆ

```bash
# Ubuntu/Debian
sudo apt install curl gnupg2 ca-certificates lsb-release ubuntu-keyring

curl https://nginx.org/keys/nginx_signing.key | gpg --dearmor \
    | sudo tee /usr/share/keyrings/nginx-archive-keyring.gpg >/dev/null

echo "deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \
http://nginx.org/packages/ubuntu `lsb_release -cs` nginx" \
    | sudo tee /etc/apt/sources.list.d/nginx.list

sudo apt update
sudo apt install nginx
```

---

## macOS å®‰è£…

### ä½¿ç”¨ Homebrew

```bash
# å®‰è£… Homebrewï¼ˆå¦‚æœªå®‰è£…ï¼‰
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# å®‰è£… Nginx
brew install nginx

# å¯åŠ¨ Nginx
brew services start nginx

# åœæ­¢ Nginx
brew services stop nginx
```

---

## Windows å®‰è£…

### ä½¿ç”¨ Chocolatey

```powershell
# å®‰è£… Chocolateyï¼ˆå¦‚æœªå®‰è£…ï¼‰
Set-ExecutionPolicy Bypass -Scope Process -Force; \
  [System.Net.ServicePointManager]::SecurityProtocol = \
  [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; \
  iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

# å®‰è£… Nginx
choco install nginx

# å¯åŠ¨ Nginx
nginx
```

### æ‰‹åŠ¨å®‰è£…

1. ä¸‹è½½ Nginx for Windows: http://nginx.org/en/download.html
2. è§£åŽ‹åˆ° `C:\nginx`
3. åŒå‡» `nginx.exe` å¯åŠ¨
4. æˆ–ä½¿ç”¨å‘½ä»¤è¡Œï¼š
   ```cmd
   cd C:\nginx
   start nginx
   ```

---

## æºç ç¼–è¯‘å®‰è£…

### å‡†å¤‡çŽ¯å¢ƒ

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install build-essential libpcre3 libpcre3-dev zlib1g zlib1g-dev \
                 libssl-dev libgd-dev libxml2 libxml2-dev uuid-dev

# CentOS/RHEL
sudo yum groupinstall "Development Tools"
sudo yum install pcre-devel zlib-devel openssl-devel gd-devel libxml2-devel
```

### ç¼–è¯‘å®‰è£…

```bash
# ä¸‹è½½æºç 
cd /usr/src
wget http://nginx.org/download/nginx-1.24.0.tar.gz
tar -zxvf nginx-1.24.0.tar.gz
cd nginx-1.24.0

# é…ç½®
./configure \
    --prefix=/etc/nginx \
    --sbin-path=/usr/sbin/nginx \
    --conf-path=/etc/nginx/nginx.conf \
    --error-log-path=/var/log/nginx/error.log \
    --http-log-path=/var/log/nginx/access.log \
    --pid-path=/var/run/nginx.pid \
    --lock-path=/var/run/nginx.lock \
    --with-http_ssl_module \
    --with-http_realip_module \
    --with-http_addition_module \
    --with-http_sub_module \
    --with-http_dav_module \
    --with-http_flv_module \
    --with-http_mp4_module \
    --with-http_gunzip_module \
    --with-http_gzip_static_module \
    --with-http_random_index_module \
    --with-http_secure_link_module \
    --with-http_stub_status_module \
    --with-http_auth_request_module \
    --with-http_xslt_module=dynamic \
    --with-http_image_filter_module=dynamic \
    --with-http_geoip_module=dynamic \
    --with-http_perl_module=dynamic \
    --with-threads \
    --with-stream \
    --with-stream_ssl_module \
    --with-stream_ssl_preread_module \
    --with-mail \
    --with-mail_ssl_module \
    --with-file-aio \
    --with-http_v2_module \
    --with-ipv6

# ç¼–è¯‘å’Œå®‰è£…
make
sudo make install

# åˆ›å»º systemd æœåŠ¡
sudo cat > /etc/systemd/system/nginx.service << EOF
[Unit]
Description=nginx - high performance web server
Documentation=http://nginx.org/en/docs/
After=network-online.target remote-fs.target nss-lookup.target
Wants=network-online.target

[Service]
Type=forking
PIDFile=/var/run/nginx.pid
ExecStartPre=/usr/sbin/nginx -t -c /etc/nginx/nginx.conf
ExecStart=/usr/sbin/nginx -c /etc/nginx/nginx.conf
ExecReload=/bin/kill -s HUP \$MAINPID
ExecStop=/bin/kill -s TERM \$MAINPID

[Install]
WantedBy=multi-user.target
EOF

# å¯åŠ¨ Nginx
sudo systemctl daemon-reload
sudo systemctl start nginx
sudo systemctl enable nginx
```

---

## éªŒè¯å®‰è£…

### æ£€æŸ¥ç‰ˆæœ¬

```bash
nginx -v
# æˆ–
nginx -V  # æ˜¾ç¤ºè¯¦ç»†ç¼–è¯‘ä¿¡æ¯
```

### æ£€æŸ¥é…ç½®

```bash
nginx -t
```

### è®¿é—®æµ‹è¯•

```bash
# æµè§ˆå™¨è®¿é—®
http://localhost

# æˆ–ä½¿ç”¨ curl
curl http://localhost
```

å¦‚æžœçœ‹åˆ° Nginx æ¬¢è¿Žé¡µé¢,è¯´æ˜Žå®‰è£…æˆåŠŸã€‚

---

## çŽ¯å¢ƒé…ç½®

### ç›®å½•ç»“æž„

```
/etc/nginx/                    # ä¸»é…ç½®ç›®å½•
â”œâ”€â”€ nginx.conf                 # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ mime.types                 # MIME ç±»åž‹å®šä¹‰
â”œâ”€â”€ fastcgi_params             # FastCGI å‚æ•°
â”œâ”€â”€ uwsgi_params               # uWSGI å‚æ•°
â”œâ”€â”€ scgi_params                # SCGI å‚æ•°
â”œâ”€â”€ conf.d/                    # é€šç”¨é…ç½®ç‰‡æ®µ
â”œâ”€â”€ sites-available/           # å¯ç”¨ç«™ç‚¹é…ç½®ï¼ˆUbuntu/Debianï¼‰
â”œâ”€â”€ sites-enabled/             # å¯ç”¨ç«™ç‚¹é…ç½®ï¼ˆUbuntu/Debianï¼‰
â””â”€â”€ modules-available/         # å¯ç”¨æ¨¡å—ï¼ˆUbuntu/Debianï¼‰
    â””â”€â”€ *.conf

/var/log/nginx/                # æ—¥å¿—ç›®å½•
â”œâ”€â”€ access.log                 # è®¿é—®æ—¥å¿—
â””â”€â”€ error.log                  # é”™è¯¯æ—¥å¿—

/var/www/html/                 # é»˜è®¤ç½‘ç«™æ ¹ç›®å½•ï¼ˆUbuntu/Debianï¼‰
/usr/share/nginx/html/         # é»˜è®¤ç½‘ç«™æ ¹ç›®å½•ï¼ˆCentOS/RHELï¼‰
```

### å¸¸ç”¨å‘½ä»¤

```bash
# å¯åŠ¨ Nginx
sudo systemctl start nginx

# åœæ­¢ Nginx
sudo systemctl stop nginx

# é‡å¯ Nginx
sudo systemctl restart nginx

# é‡è½½é…ç½®ï¼ˆä¸ä¸­æ–­æœåŠ¡ï¼‰
sudo systemctl reload nginx
# æˆ–
sudo nginx -s reload

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status nginx

# å¼€æœºè‡ªå¯
sudo systemctl enable nginx

# ç¦ç”¨å¼€æœºè‡ªå¯
sudo systemctl disable nginx
```

### é˜²ç«å¢™é…ç½®

```bash
# Ubuntu/Debian (ufw)
sudo ufw allow 'Nginx Full'
sudo ufw allow 'Nginx HTTP'
sudo ufw allow 'Nginx HTTPS'

# CentOS/RHEL (firewalld)
sudo firewall-cmd --permanent --zone=public --add-service=http
sudo firewall-cmd --permanent --zone=public --add-service=https
sudo firewall-cmd --reload
```

### é…ç½®æ–‡ä»¶æƒé™

```bash
# è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™
sudo chown -R www-data:www-data /var/www/html
sudo chmod -R 755 /var/www/html

# Nginx è¿›ç¨‹ç”¨æˆ·
user www-data;  # Ubuntu/Debian
user nginx;     # CentOS/RHEL
```

---

## ðŸ”§ å¸¸è§é—®é¢˜

### ç«¯å£è¢«å ç”¨

```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo netstat -tulpn | grep :80
sudo lsof -i :80

# åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹
sudo systemctl stop apache2  # å¦‚æžœ Apache å ç”¨
```

### SELinux é—®é¢˜ï¼ˆCentOS/RHELï¼‰

```bash
# ä¸´æ—¶ç¦ç”¨ SELinux
sudo setenforce 0

# æ°¸ä¹…ç¦ç”¨ SELinux
sudo sed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config
```

### æƒé™é—®é¢˜

```bash
# æ£€æŸ¥ Nginx è¿è¡Œç”¨æˆ·
ps aux | grep nginx

# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la /var/www/html/

# ä¿®å¤æƒé™
sudo chown -R www-data:www-data /var/www/html
```

---

## ðŸ“š ç›¸å…³é“¾æŽ¥

- [Nginx æ ¸å¿ƒæ¦‚å¿µ](../01-åŸºç¡€å…¥é—¨/æ ¸å¿ƒæ¦‚å¿µ.md)
- [Nginx åŸºæœ¬å‘½ä»¤](../01-åŸºç¡€å…¥é—¨/åŸºæœ¬å‘½ä»¤.md)
- [é…ç½®æ–‡ä»¶ç»“æž„](../02-é…ç½®ç®¡ç†/é…ç½®æ–‡ä»¶ç»“æž„.md)

---

**æ ‡ç­¾**: #nginx #å®‰è£… #é…ç½® #è¿ç»´
