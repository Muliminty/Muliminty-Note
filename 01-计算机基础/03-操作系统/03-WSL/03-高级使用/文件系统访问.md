# WSL æ–‡ä»¶ç³»ç»Ÿè®¿é—®

> Windows ä¸ Linux æ–‡ä»¶ç³»ç»Ÿäº’è®¿ã€è·¯å¾„è½¬æ¢å’Œæ€§èƒ½ä¼˜åŒ–

---

## ğŸ“‹ ç›®å½•

- [Windows è®¿é—® Linux æ–‡ä»¶ç³»ç»Ÿ](#windows-è®¿é—®-linux-æ–‡ä»¶ç³»ç»Ÿ)
- [Linux è®¿é—® Windows æ–‡ä»¶ç³»ç»Ÿ](#linux-è®¿é—®-windows-æ–‡ä»¶ç³»ç»Ÿ)
- [è·¯å¾„è½¬æ¢](#è·¯å¾„è½¬æ¢)
- [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
- [æ–‡ä»¶æƒé™é—®é¢˜](#æ–‡ä»¶æƒé™é—®é¢˜)

---

## Windows è®¿é—® Linux æ–‡ä»¶ç³»ç»Ÿ

### é€šè¿‡æ–‡ä»¶èµ„æºç®¡ç†å™¨

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ \\wsl$ è·¯å¾„

1. æ‰“å¼€æ–‡ä»¶èµ„æºç®¡ç†å™¨
2. åœ¨åœ°å€æ è¾“å…¥ï¼š`\\wsl$`
3. æˆ–è¾“å…¥ï¼š`\\wsl$\Ubuntu-22.04`

**è·¯å¾„æ ¼å¼**ï¼š
```
\\wsl$\<DistroName>\<LinuxPath>
```

**ç¤ºä¾‹**ï¼š
```
\\wsl$\Ubuntu-22.04\home\username
\\wsl$\Ubuntu-22.04\etc
\\wsl$\Ubuntu-22.04\var\www
```

#### æ–¹æ³•äºŒï¼šä»å¼€å§‹èœå•

1. åœ¨å¼€å§‹èœå•æœç´¢ Linux å‘è¡Œç‰ˆåç§°
2. å³é”®ç‚¹å‡»å‘è¡Œç‰ˆ
3. é€‰æ‹©"åœ¨æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­æ‰“å¼€"

#### æ–¹æ³•ä¸‰ï¼šæ˜ å°„ç½‘ç»œé©±åŠ¨å™¨

```powershell
# åœ¨ PowerShell ä¸­æ˜ å°„ç½‘ç»œé©±åŠ¨å™¨
net use Z: \\wsl$\Ubuntu-22.04\home\username
```

### é€šè¿‡å‘½ä»¤è¡Œ

```powershell
# åœ¨ PowerShell ä¸­è®¿é—®
cd \\wsl$\Ubuntu-22.04\home\username

# åˆ—å‡ºæ–‡ä»¶
dir \\wsl$\Ubuntu-22.04\home\username

# å¤åˆ¶æ–‡ä»¶
copy \\wsl$\Ubuntu-22.04\home\username\file.txt C:\Users\YourUsername\Desktop\
```

### é€šè¿‡ VS Code

```powershell
# åœ¨ PowerShell ä¸­
code \\wsl$\Ubuntu-22.04\home\username\project

# æˆ–åœ¨ VS Code ä¸­
# File â†’ Open Folder â†’ è¾“å…¥ \\wsl$\Ubuntu-22.04\home\username\project
```

---

## Linux è®¿é—® Windows æ–‡ä»¶ç³»ç»Ÿ

### Windows é©±åŠ¨å™¨æŒ‚è½½

WSL è‡ªåŠ¨å°† Windows é©±åŠ¨å™¨æŒ‚è½½åˆ° `/mnt/` ç›®å½•ä¸‹ã€‚

```bash
# è®¿é—® C: é©±åŠ¨å™¨
cd /mnt/c

# è®¿é—® D: é©±åŠ¨å™¨
cd /mnt/d

# è®¿é—®ç”¨æˆ·ç›®å½•
cd /mnt/c/Users/YourUsername

# åˆ—å‡ºæ–‡ä»¶
ls /mnt/c/Users/YourUsername/Desktop
```

### æŒ‚è½½ç‚¹é…ç½®

WSL è‡ªåŠ¨æŒ‚è½½é…ç½®åœ¨ `/etc/wsl.conf` ä¸­ï¼š

```ini
[automount]
enabled = true
root = /mnt/
options = "metadata,umask=22,fmask=11"
crossDistro = false
```

#### é…ç½®é€‰é¡¹è¯´æ˜

- **enabled**ï¼šæ˜¯å¦å¯ç”¨è‡ªåŠ¨æŒ‚è½½
- **root**ï¼šæŒ‚è½½ç‚¹æ ¹ç›®å½•ï¼ˆé»˜è®¤ `/mnt/`ï¼‰
- **options**ï¼šæŒ‚è½½é€‰é¡¹
  - `metadata`ï¼šå¯ç”¨æ–‡ä»¶å…ƒæ•°æ®æ”¯æŒ
  - `umask=22`ï¼šç›®å½•æƒé™æ©ç ï¼ˆ755ï¼‰
  - `fmask=11`ï¼šæ–‡ä»¶æƒé™æ©ç ï¼ˆ644ï¼‰
- **crossDistro**ï¼šæ˜¯å¦è·¨å‘è¡Œç‰ˆå…±äº«æŒ‚è½½

### è‡ªå®šä¹‰æŒ‚è½½ç‚¹

```bash
# æ‰‹åŠ¨æŒ‚è½½ï¼ˆéœ€è¦ root æƒé™ï¼‰
sudo mount -t drvfs C: /mnt/c

# å¸è½½
sudo umount /mnt/c
```

### è®¿é—® Windows æ–‡ä»¶

```bash
# è¯»å–æ–‡ä»¶
cat /mnt/c/Users/YourUsername/file.txt

# ç¼–è¾‘æ–‡ä»¶
nano /mnt/c/Users/YourUsername/file.txt
code /mnt/c/Users/YourUsername/project

# å¤åˆ¶æ–‡ä»¶
cp /mnt/c/Users/YourUsername/file.txt ~/file.txt

# åˆ›å»ºç¬¦å·é“¾æ¥
ln -s /mnt/c/Users/YourUsername/Projects ~/projects
```

---

## è·¯å¾„è½¬æ¢

### Windows è·¯å¾„è½¬ Linux è·¯å¾„

**è§„åˆ™**ï¼š
- é©±åŠ¨å™¨å­—æ¯è½¬æ¢ä¸ºå°å†™
- åæ–œæ è½¬æ¢ä¸ºæ­£æ–œæ 
- å†’å·ç§»é™¤

**ç¤ºä¾‹**ï¼š
```
C:\Users\Username\file.txt
â†’ /mnt/c/Users/Username/file.txt

D:\Projects\app
â†’ /mnt/d/Projects/app
```

### Linux è·¯å¾„è½¬ Windows è·¯å¾„

**è§„åˆ™**ï¼š
- `/mnt/<drive>/` è½¬æ¢ä¸º `<drive>:\`
- æ­£æ–œæ è½¬æ¢ä¸ºåæ–œæ 

**ç¤ºä¾‹**ï¼š
```
/mnt/c/Users/Username/file.txt
â†’ C:\Users\Username\file.txt

/home/username/project
â†’ \\wsl$\Ubuntu-22.04\home\username\project
```

### ä½¿ç”¨ wslpath è½¬æ¢

```bash
# Linux è·¯å¾„è½¬ Windows è·¯å¾„
wslpath -w /home/username/file.txt
# è¾“å‡ºï¼š\\wsl$\Ubuntu-22.04\home\username\file.txt

# Windows è·¯å¾„è½¬ Linux è·¯å¾„
wslpath "C:\Users\Username\file.txt"
# è¾“å‡ºï¼š/mnt/c/Users/Username/file.txt

# æ˜¾ç¤º Unix è·¯å¾„ï¼ˆç›¸å¯¹è·¯å¾„ï¼‰
wslpath -u "C:\Users\Username\file.txt"
# è¾“å‡ºï¼š/mnt/c/Users/Username/file.txt

# æ˜¾ç¤º Windows è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„ï¼‰
wslpath -a /home/username
# è¾“å‡ºï¼š\\wsl$\Ubuntu-22.04\home\username
```

### åœ¨è„šæœ¬ä¸­ä½¿ç”¨è·¯å¾„è½¬æ¢

```bash
#!/bin/bash
# è·å– Windows è·¯å¾„
WIN_PATH=$(wslpath -w "$1")
echo "Windows path: $WIN_PATH"

# åœ¨ Windows ä¸­æ‰§è¡Œå‘½ä»¤
cmd.exe /c "echo $WIN_PATH"
```

---

## æ€§èƒ½ä¼˜åŒ–

### WSL 1 vs WSL 2 æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½

#### WSL 1
- **Windows æ–‡ä»¶ç³»ç»Ÿ**ï¼šæ€§èƒ½è¾ƒå¥½
- **Linux æ–‡ä»¶ç³»ç»Ÿ**ï¼šæ€§èƒ½è¾ƒå·®ï¼ˆå¤§é‡å°æ–‡ä»¶æ“ä½œï¼‰

#### WSL 2
- **Windows æ–‡ä»¶ç³»ç»Ÿ**ï¼šæ€§èƒ½è¾ƒå·®ï¼ˆéœ€è¦é€šè¿‡ 9p åè®®ï¼‰
- **Linux æ–‡ä»¶ç³»ç»Ÿ**ï¼šæ€§èƒ½ä¼˜ç§€ï¼ˆext4 æ–‡ä»¶ç³»ç»Ÿï¼‰

### æœ€ä½³å®è·µ

#### 1. é¡¹ç›®æ–‡ä»¶ä½ç½®

**æ¨è**ï¼šå°†é¡¹ç›®æ–‡ä»¶æ”¾åœ¨ Linux æ–‡ä»¶ç³»ç»Ÿä¸­

```bash
# æ¨èï¼šLinux æ–‡ä»¶ç³»ç»Ÿ
/home/username/projects/myapp

# ä¸æ¨èï¼šWindows æ–‡ä»¶ç³»ç»Ÿ
/mnt/c/Users/Username/projects/myapp
```

**åŸå› **ï¼š
- WSL 2 ä¸­ Linux æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½æ›´å¥½
- é¿å…æ–‡ä»¶æƒé™é—®é¢˜
- æ›´å¥½çš„ç¬¦å·é“¾æ¥æ”¯æŒ

#### 2. ä½¿ç”¨ç¬¦å·é“¾æ¥

```bash
# åœ¨ Linux æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºæŒ‡å‘ Windows ç›®å½•çš„ç¬¦å·é“¾æ¥
ln -s /mnt/c/Users/Username/Documents ~/Documents

# åœ¨ Windows ä¸­åˆ›å»ºæŒ‡å‘ Linux ç›®å½•çš„å¿«æ·æ–¹å¼
# æˆ–ä½¿ç”¨ mklinkï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
```

#### 3. é¿å…é¢‘ç¹è·¨æ–‡ä»¶ç³»ç»Ÿæ“ä½œ

```bash
# ä¸æ¨èï¼šé¢‘ç¹åœ¨ Windows å’Œ Linux æ–‡ä»¶ç³»ç»Ÿé—´å¤åˆ¶
cp /mnt/c/file.txt ~/file.txt
# ä¿®æ”¹æ–‡ä»¶
cp ~/file.txt /mnt/c/file.txt

# æ¨èï¼šåœ¨ Linux æ–‡ä»¶ç³»ç»Ÿä¸­å·¥ä½œ
cp ~/file.txt ~/file_backup.txt
# ä¿®æ”¹æ–‡ä»¶
# å®Œæˆåä¸€æ¬¡æ€§å¤åˆ¶åˆ° Windows
```

### æ€§èƒ½æµ‹è¯•

```bash
# æµ‹è¯•æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½
# åœ¨ Linux æ–‡ä»¶ç³»ç»Ÿä¸­
time for i in {1..1000}; do touch /home/username/test$i; done

# åœ¨ Windows æ–‡ä»¶ç³»ç»Ÿä¸­
time for i in {1..1000}; do touch /mnt/c/Users/Username/test$i; done
```

---

## æ–‡ä»¶æƒé™é—®é¢˜

### å¸¸è§é—®é¢˜

#### 1. æ–‡ä»¶æƒé™æ˜¾ç¤ºä¸º 777

**åŸå› **ï¼šWindows æ–‡ä»¶ç³»ç»Ÿä¸æ”¯æŒ Linux æ–‡ä»¶æƒé™

**è§£å†³æ–¹æ¡ˆ**ï¼š
- åœ¨ `/etc/wsl.conf` ä¸­é…ç½®æŒ‚è½½é€‰é¡¹
- ä½¿ç”¨ `metadata` é€‰é¡¹å¯ç”¨å…ƒæ•°æ®æ”¯æŒ

```ini
[automount]
options = "metadata,umask=22,fmask=11"
```

#### 2. æ— æ³•æ‰§è¡Œè„šæœ¬

**åŸå› **ï¼šæ–‡ä»¶æ²¡æœ‰æ‰§è¡Œæƒé™

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x script.sh

# æˆ–ä½¿ç”¨ bash ç›´æ¥æ‰§è¡Œ
bash script.sh
```

#### 3. æ–‡ä»¶æ‰€æœ‰è€…é—®é¢˜

**åŸå› **ï¼šåœ¨ Windows ä¸­åˆ›å»ºçš„æ–‡ä»¶æ‰€æœ‰è€…å¯èƒ½ä¸æ­£ç¡®

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…
sudo chown username:username file.txt

# é€’å½’ä¿®æ”¹ç›®å½•
sudo chown -R username:username directory
```

### æƒé™æ˜ å°„

WSL å°è¯•å°† Windows æ–‡ä»¶æƒé™æ˜ å°„åˆ° Linux æƒé™ï¼š

- **Windows åªè¯»** â†’ Linux `444` æˆ– `555`
- **Windows è¯»å†™** â†’ Linux `666` æˆ– `777`
- **Windows æ‰§è¡Œ** â†’ Linux `755` æˆ– `777`

### å¤„ç† Windows æ–‡ä»¶æƒé™

```bash
# æŸ¥çœ‹æ–‡ä»¶æƒé™
ls -l /mnt/c/Users/Username/file.txt

# ä¿®æ”¹æƒé™ï¼ˆå¯èƒ½ä¸ç”Ÿæ•ˆï¼Œå–å†³äºæ–‡ä»¶ç³»ç»Ÿï¼‰
chmod 644 /mnt/c/Users/Username/file.txt

# æœ€ä½³å®è·µï¼šå¤åˆ¶åˆ° Linux æ–‡ä»¶ç³»ç»Ÿ
cp /mnt/c/Users/Username/file.txt ~/file.txt
chmod 644 ~/file.txt
```

---

## ç‰¹æ®Šæ–‡ä»¶ç³»ç»Ÿæ“ä½œ

### ç¬¦å·é“¾æ¥

#### åœ¨ Linux ä¸­åˆ›å»ºç¬¦å·é“¾æ¥

```bash
# åˆ›å»ºç¬¦å·é“¾æ¥
ln -s /mnt/c/Users/Username/Documents ~/Documents

# åˆ›å»ºç»å¯¹è·¯å¾„ç¬¦å·é“¾æ¥
ln -s /mnt/c/Users/Username/Projects ~/projects

# æŸ¥çœ‹ç¬¦å·é“¾æ¥
ls -l ~/Documents
```

#### Windows ç¬¦å·é“¾æ¥æ”¯æŒ

WSL 2 æ”¯æŒ Windows ç¬¦å·é“¾æ¥ï¼Œä½†éœ€è¦æ³¨æ„ï¼š
- Windows ç¬¦å·é“¾æ¥åœ¨ Linux ä¸­å¯èƒ½æ˜¾ç¤ºä¸ºæ™®é€šæ–‡ä»¶
- Linux ç¬¦å·é“¾æ¥åœ¨ Windows ä¸­å¯èƒ½æ— æ³•æ­£ç¡®è§£æ

### ç¡¬é“¾æ¥

```bash
# åˆ›å»ºç¡¬é“¾æ¥ï¼ˆä»…åœ¨åŒä¸€æ–‡ä»¶ç³»ç»Ÿå†…ï¼‰
ln /mnt/c/file.txt /mnt/c/file_link.txt

# ç¡¬é“¾æ¥ä¸èƒ½è·¨æ–‡ä»¶ç³»ç»Ÿ
# ä»¥ä¸‹å‘½ä»¤ä¼šå¤±è´¥ï¼š
ln /mnt/c/file.txt ~/file_link.txt  # é”™è¯¯
```

### æ–‡ä»¶é”å®š

```bash
# Linux æ–‡ä»¶ç³»ç»Ÿæ”¯æŒå®Œæ•´çš„æ–‡ä»¶é”å®š
# Windows æ–‡ä»¶ç³»ç»Ÿé”å®šæ”¯æŒæœ‰é™

# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦è¢«é”å®š
lsof /path/to/file
```

---

## å¤‡ä»½ä¸æ¢å¤

### å¤‡ä»½ Linux æ–‡ä»¶ç³»ç»Ÿ

```powershell
# åœ¨ PowerShell ä¸­å¯¼å‡ºå‘è¡Œç‰ˆ
wsl --export Ubuntu-22.04 D:\Backup\ubuntu-22.04-backup.tar
```

### å¤‡ä»½ç‰¹å®šç›®å½•

```bash
# åœ¨ WSL ä¸­
tar -czf ~/backup.tar.gz /home/username/projects

# å¤åˆ¶åˆ° Windows
cp ~/backup.tar.gz /mnt/c/Users/Username/Desktop/
```

### æ¢å¤æ–‡ä»¶

```bash
# è§£å‹å¤‡ä»½
tar -xzf backup.tar.gz -C /home/username/

# ä» Windows å¤åˆ¶æ–‡ä»¶
cp /mnt/c/Users/Username/backup/file.txt ~/file.txt
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [WSL æ–‡ä»¶ç³»ç»Ÿè®¿é—®æ–‡æ¡£](https://learn.microsoft.com/zh-cn/windows/wsl/filesystems)
- [WSL æ€§èƒ½ä¼˜åŒ–](https://learn.microsoft.com/zh-cn/windows/wsl/compare-versions)

---

[[!MOC-WSL|è¿”å› WSL çŸ¥è¯†ä½“ç³»]]

#WSL #æ–‡ä»¶ç³»ç»Ÿ #è·¯å¾„è½¬æ¢ #æ€§èƒ½ä¼˜åŒ–
