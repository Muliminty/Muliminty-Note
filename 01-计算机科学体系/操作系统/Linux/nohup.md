### è¯¦ç»†ä½¿ç”¨æ–‡æ¡£ï¼š`nohup` å¯åŠ¨å’Œå…³é—­ npm åº”ç”¨

#### ä¸€ã€æ ¸å¿ƒæ¦‚å¿µ

â€‹**â€‹`nohup` æ˜¯ä»€ä¹ˆï¼Ÿâ€‹**â€‹  
å°†å‘½ä»¤è®¾ä¸ºâ€‹**â€‹åŽå°å®ˆæŠ¤è¿›ç¨‹â€‹**â€‹ï¼Œå³ä½¿å…³é—­ç»ˆç«¯æˆ–é€€å‡º SSHï¼Œè¿›ç¨‹ä»æŒç»­è¿è¡Œã€‚é»˜è®¤è¾“å‡ºé‡å®šå‘åˆ° `nohup.out` æ–‡ä»¶ã€‚

â€‹**â€‹é€‚ç”¨åœºæ™¯â€‹**â€‹

- æœåŠ¡å™¨éƒ¨ç½²æ—¶å¯åŠ¨ Web æœåŠ¡ï¼ˆå¦‚ `npm run start`ï¼‰
- éœ€è¦é•¿æœŸè¿è¡Œä¸”ä¸è¢«ç»ˆç«¯å…³é—­å½±å“çš„è¿›ç¨‹

---

#### äºŒã€å¯åŠ¨ npm åº”ç”¨

##### å‘½ä»¤æ ¼å¼ï¼ˆæ ¸å¿ƒï¼‰

```
nohup npm run start > æ—¥å¿—æ–‡ä»¶è·¯å¾„ 2>&1 &
```

- â€‹**â€‹`> æ—¥å¿—æ–‡ä»¶è·¯å¾„`â€‹**â€‹ï¼šå°†æ ‡å‡†è¾“å‡ºï¼ˆæ­£å¸¸æ—¥å¿—ï¼‰å†™å…¥æŒ‡å®šæ–‡ä»¶ï¼ˆå¦‚ `app.log`ï¼‰
- â€‹**â€‹`2>&1`â€‹**â€‹ï¼šå°†æ ‡å‡†é”™è¯¯ï¼ˆå¦‚æŠ¥é”™ï¼‰é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼ˆå³åŒä¸€æ—¥å¿—æ–‡ä»¶ï¼‰
- â€‹**â€‹`&`â€‹**â€‹ï¼šåŽå°è¿è¡Œ

##### ç¤ºä¾‹ï¼šå¯åŠ¨é¡¹ç›®å¹¶ä¿å­˜æ—¥å¿—

```
# å¯åŠ¨é¡¹ç›®ï¼Œæ—¥å¿—ä¿å­˜åˆ°å½“å‰ç›®å½•çš„ app.log
nohup npm run start > ./app.log 2>&1 &
```

â€‹**â€‹æ‰§è¡ŒåŽè¿”å›žæç¤ºâ€‹**â€‹

```
[1] 12345  # 12345 æ˜¯è¿›ç¨‹ PIDï¼ˆå…³é”®ï¼åŽç»­å…³é—­éœ€ç”¨åˆ°ï¼‰
```

##### éªŒè¯æ˜¯å¦å¯åŠ¨æˆåŠŸ

```
# æŸ¥çœ‹æ—¥å¿—å°¾éƒ¨ï¼ˆæŒç»­ç›‘æŽ§ç”¨ Ctrl+C é€€å‡ºï¼‰
tail -f app.log  

# æŸ¥çœ‹åŒ…å« npm çš„è¿›ç¨‹
ps aux | grep npm
```

---

#### ä¸‰ã€å…³é—­æŒ‡å®šè¿›ç¨‹

éœ€é€šè¿‡ â€‹**â€‹PIDï¼ˆè¿›ç¨‹ IDï¼‰â€‹**â€‹ å…³é—­è¿›ç¨‹ã€‚

##### æ­¥éª¤ 1ï¼šæŸ¥æ‰¾è¿›ç¨‹ PID

â€‹**â€‹æ–¹æ³• 1ï¼šé€šè¿‡ `ps` + `grep` æŸ¥æ‰¾â€‹**â€‹

```
ps aux | grep 'npm run start'
```

â€‹**â€‹è¾“å‡ºç¤ºä¾‹â€‹**â€‹

```
user   12345  0.0  0.1  00000000  ?  SL   Jan01   0:00 npm run start
```

> âœ… â€‹**â€‹PID = `12345`â€‹**â€‹ï¼ˆç¬¬äºŒåˆ—æ•°å­—ï¼‰

â€‹**â€‹æ–¹æ³• 2ï¼šç›´æŽ¥æå– PIDï¼ˆè‡ªåŠ¨åŒ–å‘½ä»¤ï¼‰â€‹**â€‹

```
pid=$(ps aux | grep 'npm run start' | grep -v grep | awk '{print $2}')
echo $pid  # æ‰“å° PID ç¡®è®¤
```

##### æ­¥éª¤ 2ï¼šå…³é—­è¿›ç¨‹

```
kill -9 12345  # æ›¿æ¢ä¸ºå®žé™… PID
```

##### âš ï¸ å¸¸è§é—®é¢˜

â€‹**â€‹Qï¼šå…³é—­åŽè¿›ç¨‹ä»åœ¨ï¼Ÿâ€‹**â€‹  
å¯èƒ½æ˜¯å­è¿›ç¨‹ï¼ˆå¦‚ Node.jsï¼‰æœªå…³é—­ã€‚â€‹**â€‹è¡¥å……å‘½ä»¤â€‹**â€‹ï¼š

```
# å…³é—­ä¸»è¿›ç¨‹åŽï¼Œå†å…³é—­ç›¸å…³ node è¿›ç¨‹
pkill -f node
```

---

#### å››ã€æœ€ä½³å®žè·µ

##### æ–¹æ¡ˆ 1ï¼šå¯åŠ¨æ—¶ä¿å­˜ PIDï¼ˆæŽ¨èï¼ï¼‰

```
# å¯åŠ¨å‘½ä»¤ï¼ˆåŒæ—¶è®°å½• PID åˆ°æ–‡ä»¶ï¼‰
nohup npm run start > app.log 2>&1 & echo $! > app.pid
```

â€‹**â€‹å…³é—­æ—¶ç›´æŽ¥è°ƒç”¨ PID æ–‡ä»¶â€‹**â€‹

```
kill -9 $(cat app.pid)
```

##### æ–¹æ¡ˆ 2ï¼šç«¯å£å…³é—­æ³•ï¼ˆé€‚åˆå·²çŸ¥ç«¯å£ï¼‰

```
# æŸ¥æ‰¾å ç”¨ç«¯å£ï¼ˆå¦‚ 3000ï¼‰çš„ PID
lsof -i :3000 | awk 'NR==2 {print $2}' | xargs kill -9
```

---

#### äº”ã€å…³é”®æ€»ç»“

|æ“ä½œ|å‘½ä»¤|
|---|---|
|â€‹**â€‹å¯åŠ¨åº”ç”¨â€‹**â€‹|`nohup npm run start > app.log 2>&1 &`|
|â€‹**â€‹ä¿å­˜ PIDâ€‹**â€‹|å¯åŠ¨åŽæ·»åŠ  `echo $! > app.pid`|
|â€‹**â€‹å…³é—­åº”ç”¨â€‹**â€‹|`kill -9 $(cat app.pid)` æˆ–æ‰‹åŠ¨ `kill -9 PID`|
|â€‹**â€‹æŸ¥æ®‹ä½™è¿›ç¨‹â€‹**â€‹|`pkill -f node` æˆ– `ps aux \| grep node`|

> ðŸ’¡ â€‹**â€‹ç»ˆæžå‘½ä»¤â€‹**â€‹ï¼šä¸€é”®å…³é—­æ•´ä¸ªè¿›ç¨‹æ ‘
> 
> ```
> pkill -f 'npm run start'  # å¼ºåˆ¶ç»ˆæ­¢æ‰€æœ‰åŒ¹é…è¿›ç¨‹
> ```