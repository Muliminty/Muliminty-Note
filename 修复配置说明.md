# 修复配置说明

## 问题：部署后目录和双链预览不显示

### 可能的原因

1. **布局配置未正确加载**
2. **依赖未正确安装**
3. **构建时配置未正确应用**

### 解决步骤

#### 1. 确保配置文件存在且正确

确保以下文件存在：
- `quartz.config.ts` - 主配置文件
- `quartz.layout.ts` - 布局配置文件

#### 2. 检查布局配置导入

在 `quartz.config.ts` 中确保正确导入：

```typescript
import * as Shared from "./quartz.layout"

const config: QuartzConfig = {
  // ...
  layout: {
    sharedPageComponents: Shared.sharedPageComponents,
    defaultContentPageLayout: Shared.defaultContentPageLayout,
    defaultListPageLayout: Shared.defaultListPageLayout,
  },
}
```

#### 3. 本地测试

```bash
# 1. 安装依赖
npm install

# 2. 本地构建
npm run build

# 3. 本地预览
npm run dev
```

访问 `http://localhost:8080`，检查：
- 左侧边栏是否显示搜索框和目录
- 鼠标悬停在双链上是否有预览

#### 4. 如果本地测试正常，但部署后不正常

可能的原因：
1. **GitHub Actions 构建时的配置问题**
2. **缓存问题**

解决方案：
1. 在 GitHub Actions 中添加清理缓存的步骤
2. 确保 `quartz.layout.ts` 文件被正确提交到 Git

#### 5. 检查 GitHub Actions 日志

1. 进入 GitHub 仓库的 **Actions** 标签页
2. 查看最新的构建日志
3. 检查是否有错误信息

#### 6. 强制重新构建

```bash
# 创建一个空提交来触发重新构建
git commit --allow-empty -m "Trigger rebuild"
git push origin master
```

### 验证配置

#### 检查清单

- [ ] `quartz.config.ts` 存在且配置正确
- [ ] `quartz.layout.ts` 存在且配置正确
- [ ] `quartz.config.ts` 中导入了 `quartz.layout.ts`
- [ ] `layout` 配置已添加到 `config` 中
- [ ] `enablePopovers: true` 已设置
- [ ] `Plugin.Search()` 已添加到 emitters
- [ ] `Plugin.ObsidianFlavoredMarkdown()` 配置正确
- [ ] 文件已提交到 Git
- [ ] GitHub Actions 构建成功

### 如果问题仍然存在

1. **查看 Quartz 官方文档**：
   - https://quartz.jzhao.xyz/

2. **检查 GitHub Issues**：
   - https://github.com/jackyzha0/quartz/issues

3. **尝试简化配置**：
   - 先使用最基础的配置
   - 逐步添加功能

4. **检查 Quartz 版本**：
   - 确保使用的 Quartz 版本是最新的稳定版本
   - 检查是否有已知的 bug

