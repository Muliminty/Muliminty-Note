#每日一题/JavaScript

闭包是指函数可以访问并操作其**词法作用域**（函数定义时的作用域）之外的变量的能力。换句话说，闭包是函数以及其创建时所处的作用域的组合。

当一个内部函数引用了外部函数的变量时，闭包就形成了。内部函数可以访问外部函数的变量，即使外部函数已经执行完毕，这就是闭包的特殊之处。

以下是一个闭包的示例代码：

```javascript
function outer() {
  var outerVar = '外部变量';

  function inner() {
    console.log(outerVar); // 内部函数访问外部函数的变量
  }

  return inner;
}

var closure = outer(); // 调用外部函数，返回内部函数
closure(); // 输出：外部变量
```

在这个示例中，`outer`函数定义了一个外部变量`outerVar`，并且内部定义了一个函数`inner`。`inner`函数可以访问外部函数`outer`的作用域，包括外部变量`outerVar`。当我们调用`outer`函数时，它返回了内部函数`inner`，并将其赋值给变量`closure`。接着，我们调用`closure`函数，它会打印出外部变量`outerVar`的值，即`外部变量`。

在这个例子中，`inner`函数形成了一个闭包，因为它可以访问外部函数`outer`的作用域和变量。闭包可以帮助我们创建私有变量、实现模块化和封装等功能。

需要注意的是，闭包可能会导致内存泄漏，因为闭包中引用的外部变量不会被垃圾回收。因此，在使用闭包时需要小心，确保适当地管理内存。

---

词法作用域也被称为静态作用域或者词法环境，它是指在代码编写过程中，变量和函数的可访问性是由它们在代码中定义的位置决定的。换句话说，词法作用域是在代码编写阶段就确定的，与函数的调用方式无关。

在词法作用域中，变量和函数的作用域是由它们在代码中的位置决定的，而不是在运行时根据调用栈决定的。当代码嵌套时，内部作用域可以访问外部作用域中的变量，但反过来是不行的。

下面是一个示例来说明词法作用域的概念：

```javascript
var globalVar = '全局变量';

function outer() {
  var outerVar = '外部变量';

  function inner() {
    var innerVar = '内部变量';
    console.log(innerVar); // 可以访问内部变量
    console.log(outerVar); // 可以访问外部变量
    console.log(globalVar); // 可以访问全局变量
  }

  inner();
}

outer();
```

在这个示例中，全局变量`globalVar`可以在任意地方被访问。内部函数`inner`可以访问它自己的局部变量`innerVar`、外部函数`outer`的局部变量`outerVar`，以及全局变量`globalVar`。但是，外部函数`outer`无法直接访问内部函数`inner`的局部变量`innerVar`。

词法作用域的好处是它提供了一种明确的变量查找规则，使得代码更加可靠和可预测。它也是JavaScript中闭包的基础，因为闭包可以访问其外部函数的词法作用域。