## 🖥️ 后端 (Node.js + Express + SQLite)

安装依赖：

```bash
npm init -y
npm install express sqlite3
```

新建 `server.js`：

```js
const express = require('express');
const sqlite3 = require('sqlite3').verbose();
const bodyParser = require('body-parser');
const path = require('path');

const app = express();
const db = new sqlite3.Database('./clipboard.db');

// 创建表
db.serialize(() => {
  db.run(`CREATE TABLE IF NOT EXISTS clipboard (
    code TEXT PRIMARY KEY,
    text TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
  )`);
});

// 解析 JSON
app.use(bodyParser.json());
app.use(express.static(path.join(__dirname, 'public')));

// 生成随机验证码
function generateCode(length = 6) {
  return Math.random().toString(36).substr(2, length);
}

// 上传文本
app.post('/clipboard', (req, res) => {
  const { text } = req.body;
  if (!text) {
    return res.status(400).json({ success: false, msg: 'text 不能为空' });
  }

  const code = generateCode(6);

  db.run(`INSERT INTO clipboard (code, text) VALUES (?, ?)`, [code, text], function (err) {
    if (err) return res.status(500).json({ success: false, msg: '数据库错误' });
    res.json({ success: true, code });
  });
});

// 获取文本
app.get('/clipboard/:code', (req, res) => {
  const { code } = req.params;
  db.get(`SELECT text FROM clipboard WHERE code = ?`, [code], (err, row) => {
    if (err) return res.status(500).json({ success: false, msg: '数据库错误' });
    if (!row) return res.status(404).json({ success: false, msg: '未找到' });
    res.json({ success: true, text: row.text });
  });
});

// 简单清理接口（可选）
app.delete('/clipboard/:code', (req, res) => {
  const { code } = req.params;
  db.run(`DELETE FROM clipboard WHERE code = ?`, [code], function (err) {
    if (err) return res.status(500).json({ success: false, msg: '数据库错误' });
    res.json({ success: true, deleted: this.changes });
  });
});

const PORT = 3000;
app.listen(PORT, () => {
  console.log(`🚀 Server running at http://localhost:${PORT}`);
});
```

---

## 🌐 前端 (简单 HTML 页面)

在 `public/index.html` 新建页面：

```html
<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>云剪切板</title>
  <style>
    body { font-family: sans-serif; margin: 40px; }
    textarea { width: 100%; height: 100px; }
    input { padding: 6px; margin: 6px 0; }
    button { padding: 6px 12px; margin: 6px 0; }
    .box { margin-bottom: 20px; }
  </style>
</head>
<body>
  <h1>云剪切板</h1>

  <div class="box">
    <h3>上传文本</h3>
    <textarea id="uploadText"></textarea><br />
    <button onclick="upload()">上传</button>
    <p id="uploadResult"></p>
  </div>

  <div class="box">
    <h3>获取文本</h3>
    <input id="code" placeholder="输入验证码" />
    <button onclick="fetchText()">获取</button>
    <p id="fetchResult"></p>
  </div>

  <script>
    async function upload() {
      const text = document.getElementById('uploadText').value;
      const res = await fetch('/clipboard', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ text })
      });
      const data = await res.json();
      if (data.success) {
        document.getElementById('uploadResult').innerText = "验证码：" + data.code;
      } else {
        document.getElementById('uploadResult').innerText = "上传失败: " + data.msg;
      }
    }

    async function fetchText() {
      const code = document.getElementById('code').value.trim();
      const res = await fetch('/clipboard/' + code);
      const data = await res.json();
      if (data.success) {
        document.getElementById('fetchResult').innerText = "内容：" + data.text;
      } else {
        document.getElementById('fetchResult').innerText = "获取失败: " + data.msg;
      }
    }
  </script>
</body>
</html>
```

---

## 🚀 运行

```bash
node server.js
```

打开浏览器访问 [http://localhost:3000](http://localhost:3000/) 就可以使用了。

### 🔮 可扩展功能

- 文本有效期（SQLite 里加 `expire_at` 字段，定期清理）
    
- 验证码二维码（前端用 `qrcode.js` 生成，手机扫码直接填 code）
    
- 多端同步（加用户登录，支持多条记录）
